
  <!doctype html>
  <html lang="zh" class="no-js">
    <head>
      
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        
          <meta name="description" content="é¹¤ç¿”ä¸‡é‡Œï¼ˆTonyCraneï¼‰çš„ç¬”è®°æœ¬">
        
        
        
          <link rel="canonical" href="https://note.tonycrane.cc/writeups/hackergame2021/">
        
        <link rel="icon" href="../../assets/images/favicon.png">
        <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.4">
      
      
        
          <title>USTC Hackergame 2021 - é¹¤ç¿”ä¸‡é‡Œçš„ç¬”è®°æœ¬</title>
        
      
      
        <link rel="stylesheet" href="../../assets/stylesheets/main.bb3983ee.min.css">
        
          
          <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
          
        
      
      
      
        
          
          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
          <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=JetBrains+Mono:300,400,400i,700%7CJetBrains+Mono&display=fallback">
          <style>:root{--md-text-font:"JetBrains Mono";--md-code-font:"JetBrains Mono"}</style>
        
      
      
        <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
      
        <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
      
        <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
      
        <link rel="stylesheet" href="../../css/tasklist.css">
      
        <link rel="stylesheet" href="../../css/custom.css">
      
        <link rel="stylesheet" href="../../css/card.css">
      
      
      <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
      
        
  


  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c273de7f67d992cb6aef08c3ddf09bb2";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DYETCPM289"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-DYETCPM289",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DYETCPM289"></script>


      
      
    </head>
    
    
      
      
        
      
      
      
      
      <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
    
      <script src="../../js/scheme.js" type="text/javascript"></script>
      
      
        <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
      
      <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
      <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
      <label class="md-overlay" for="__drawer"></label>
      <div data-md-component="skip">
        
          
          <a href="#hackergame-2021-writeup" class="md-skip">
            è·³è½¬è‡³
          </a>
        
      </div>
      <div data-md-component="announce">
        
      </div>
      
      
        

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../.." title="é¹¤ç¿”ä¸‡é‡Œçš„ç¬”è®°æœ¬" class="md-header__button md-logo" aria-label="é¹¤ç¿”ä¸‡é‡Œçš„ç¬”è®°æœ¬" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4h-2M3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7H3m2-2v2h2V5H5m0 14h2v-2H5v2m0-6h2v-2H5v2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            é¹¤ç¿”ä¸‡é‡Œçš„ç¬”è®°æœ¬
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              USTC Hackergame 2021
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      <div class="md-header-nav__scheme md-header-nav__button md-source__icon md-icon">
          <a
            href="javascript:toggleScheme();"
            title="Light mode"
            class="light-mode"
          >
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
          </a>
          <a
            href="javascript:toggleScheme();"
            title="Dark mode"
            class="dark-mode"
          >
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
          </a>
          <a
            href="javascript:toggleScheme();"
            title="System preference"
            class="system-mode"
          >
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07 19.07 3.5m-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13.51 1.67m-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87.4 1.31M19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35-2.53-2.2m4.33-2.7 1.15-2.77 2.2 2.54-3.35.23m1.15-4.96-1.14-2.78 3.34.24-2.2 2.54M9.63 18.93l2.77 1.15-2.53 2.19-.24-3.34z"/></svg>
          </a>
           <a
            href="javascript:toggleScheme();"
            title="Unknown scheme"
            class="unknown-mode"
          >
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m15.07 11.25-.9.92C13.45 12.89 13 13.5 13 15h-2v-.5c0-1.11.45-2.11 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8a4 4 0 0 1 4-4 4 4 0 0 1 4 4 3.2 3.2 0 0 1-.93 2.25M13 19h-2v-2h2M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10z"/></svg>
          </a>
      </div>
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/TonyCrane/note/" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    TonyCrane/note
  </div>
</a>
      </div>
    
  </nav>
  
</header>
      
      <div class="md-container" data-md-component="container">
        
        
          
            
              
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../cs/" class="md-tabs__link">
        Computer Science
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../ctf/" class="md-tabs__link">
        CTF
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Writeups
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../hpc/" class="md-tabs__link">
        HPC
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../misc/" class="md-tabs__link">
        Miscellaneous
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
            
          
        
        <main class="md-main" data-md-component="main">
          <div class="md-main__inner md-grid">
            
              
                <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                  <div class="md-sidebar__scrollwrap">
                    <div class="md-sidebar__inner">
                      
                        

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="é¹¤ç¿”ä¸‡é‡Œçš„ç¬”è®°æœ¬" class="md-nav__button md-logo" aria-label="é¹¤ç¿”ä¸‡é‡Œçš„ç¬”è®°æœ¬" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4h-2M3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7H3m2-2v2h2V5H5m0 14h2v-2H5v2m0-6h2v-2H5v2z"/></svg>

    </a>
    é¹¤ç¿”ä¸‡é‡Œçš„ç¬”è®°æœ¬
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/TonyCrane/note/" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    TonyCrane/note
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../..">Home</a>
          
        </div>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../cs/">Computer Science</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Computer Science" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Computer Science
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../cs/pl/">ç¼–ç¨‹è¯­è¨€</a>
          
            <label for="__nav_2_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="ç¼–ç¨‹è¯­è¨€" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          ç¼–ç¨‹è¯­è¨€
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2_2" type="checkbox" id="__nav_2_2_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../cs/pl/python/">Python</a>
          
            <label for="__nav_2_2_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Python" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_2_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/pl/python/basic/" class="md-nav__link">
        åŸºç¡€è¯­æ³•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/pl/python/numpy/" class="md-nav__link">
        NumPy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/pl/python/pil/" class="md-nav__link">
        PIL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/pl/c_cpp/" class="md-nav__link">
        C/C++
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/pl/haskell/" class="md-nav__link">
        Haskell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/pl/asm/" class="md-nav__link">
        x86 æ±‡ç¼–è¯­è¨€
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/pl/riscv/" class="md-nav__link">
        RISC-V ISA
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../cs/system/">è®¡ç®—æœºç³»ç»Ÿ</a>
          
            <label for="__nav_2_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="è®¡ç®—æœºç³»ç»Ÿ" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          è®¡ç®—æœºç³»ç»Ÿ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_2" type="checkbox" id="__nav_2_3_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../cs/system/cs1/">è®¡ç®—æœºç³»ç»Ÿ I</a>
          
            <label for="__nav_2_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="è®¡ç®—æœºç³»ç»Ÿ I" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_2">
          <span class="md-nav__icon md-icon"></span>
          è®¡ç®—æœºç³»ç»Ÿ I
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/system/cs1/topic1/" class="md-nav__link">
        æ•°æ®çš„è¡¨ç¤º
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/system/cs1/topic2/" class="md-nav__link">
        æ•°å­—é€»è¾‘ç”µè·¯åŸºç¡€
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/system/cs1/topic3/" class="md-nav__link">
        ç»„åˆé€»è¾‘ç”µè·¯è®¾è®¡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/system/cs1/topic4/" class="md-nav__link">
        æ—¶åºé€»è¾‘ç”µè·¯è®¾è®¡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/system/cs1/topic5/" class="md-nav__link">
        æŒ‡ä»¤é›†ä½“ç³»ç»“æ„
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/system/cs1/topic6/" class="md-nav__link">
        å¤„ç†å™¨
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../cs/web/">ç½‘ç»œç›¸å…³</a>
          
            <label for="__nav_2_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="ç½‘ç»œç›¸å…³" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          ç½‘ç»œç›¸å…³
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/web/svg/" class="md-nav__link">
        SVG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/web/log4j_vuln/" class="md-nav__link">
        log4j æ¼æ´å¤ç°
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/regex/" class="md-nav__link">
        æ­£åˆ™è¡¨è¾¾å¼
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cs/unicode/" class="md-nav__link">
        Unicode
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../ctf/">CTF</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="CTF" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          CTF
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../ctf/steg/">éšå†™æœ¯</a>
          
            <label for="__nav_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="éšå†™æœ¯" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          éšå†™æœ¯
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/steg/image/" class="md-nav__link">
        å›¾ç‰‡éšå†™
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/steg/audio/" class="md-nav__link">
        éŸ³é¢‘éšå†™
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../ctf/escapes/">æ²™ç®±é€ƒé€¸</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="æ²™ç®±é€ƒé€¸" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          æ²™ç®±é€ƒé€¸
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/escapes/pysandbox/" class="md-nav__link">
        Python æ²™ç®±é€ƒé€¸
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/coding/" class="md-nav__link">
        ç¼–ç ä¸å¯†ç 
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/qrcode/" class="md-nav__link">
        QRCode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/esolang/" class="md-nav__link">
        Esolang
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Writeups</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Writeups" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Writeups
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Training
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Training" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Training
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ethernaut/" class="md-nav__link">
        Ethernaut
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SecurityInnovation/" class="md-nav__link">
        Security Innovation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AAA/" class="md-nav__link">
        ğŸ”’ AAA School Bus
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3">
          2021
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2021" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          2021
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sysu_msc_puzzle/" class="md-nav__link">
        SYSU MSC Puzzle 2021
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          USTC Hackergame 2021
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        USTC Hackergame 2021
      </a>
      
        
  
  <nav class="md-nav md-nav--secondary " aria-label="ç›®å½•">
    
    
    
      
    
    
      <label class="md-nav__title" for="__toc">
        <span class="md-nav__icon md-icon"></span>
        ç›®å½•
      </label>
      <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç­¾åˆ°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    è¿›åˆ¶åå…­â€”â€”å‚ä¸Š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å»å§ï¼è¿½å¯»è‡ªç”±çš„ç”µæ³¢
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pro-max" class="md-nav__link">
    çŒ«å’ªé—®ç­” Pro Max
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    å–ç“œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    é€æ˜çš„æ–‡ä»¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    æ—…è¡Œç…§ç‰‡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    FLAG åŠ©åŠ›å¤§çº¢åŒ…
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#amnesia" class="md-nav__link">
    Amnesia
  </a>
  
    <nav class="md-nav" aria-label="Amnesia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    è½»åº¦å¤±å¿†
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    å›¾ä¹‹ä¸Šçš„ä¿¡æ¯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easy-rsa" class="md-nav__link">
    Easy RSA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#u" class="md-nav__link">
    åŠ å¯†çš„ U ç›˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    èµ›åšå¨æˆ¿
  </a>
  
    <nav class="md-nav" aria-label="èµ›åšå¨æˆ¿">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#level-0" class="md-nav__link">
    Level 0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#level-1" class="md-nav__link">
    Level 1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#micro-world" class="md-nav__link">
    Micro World
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    é˜µåˆ—æ¢å¤å¤§å¸ˆ
  </a>
  
    <nav class="md-nav" aria-label="é˜µåˆ—æ¢å¤å¤§å¸ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raid-5" class="md-nav__link">
    RAID 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid-0" class="md-nav__link">
    RAID 0
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    åŠ©è®°è¯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    é©¬èµ›å…‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minecraft" class="md-nav__link">
    minecRaft
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    å¯†ç ç”Ÿæˆå™¨
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pq" class="md-nav__link">
    pğŸ˜­q
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
        
      </ul>
    
  </nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../d0g3/" class="md-nav__link">
        ç¬¬å››å±Šâ€œå®‰æ´µæ¯â€
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bytectf2021_final/" class="md-nav__link">
        ByteCTF 2021 Final
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sctf2021/" class="md-nav__link">
        SCTF 2021
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4">
          2022
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2022" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          2022
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vnctf2022/" class="md-nav__link">
        VNCTF 2022
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tqlctf2022/" class="md-nav__link">
        TQLCTF 2022
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../susctf2022/" class="md-nav__link">
        SUSCTF 2022
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../d3ctf2022/" class="md-nav__link">
        D3CTF 2022
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%2Actf2022/" class="md-nav__link">
        *CTF 2022
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mrctf2022/" class="md-nav__link">
        MRCTF 2022
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../hpc/">HPC</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="HPC" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          HPC
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_2">
          HPC 101 è¶…ç®—å°å­¦æœŸ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="HPC 101 è¶…ç®—å°å­¦æœŸ" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          HPC 101 è¶…ç®—å°å­¦æœŸ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hpc/hpc101/vectorized/" class="md-nav__link">
        å‘é‡åŒ–è®¡ç®—
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../misc/">Miscellaneous</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Miscellaneous" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Miscellaneous
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/notes/" class="md-nav__link">
        è¯¾ç¨‹ç¬”è®°
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/mkdocs/" class="md-nav__link">
        mkdocs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/hexo/" class="md-nav__link">
        hexo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/sphinx/" class="md-nav__link">
        sphinx
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                      
                    </div>
                  </div>
                </div>
              
              
                <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                  <div class="md-sidebar__scrollwrap">
                    <div class="md-sidebar__inner">
                      
                        
  
  <nav class="md-nav md-nav--secondary " aria-label="ç›®å½•">
    
    
    
      
    
    
      <label class="md-nav__title" for="__toc">
        <span class="md-nav__icon md-icon"></span>
        ç›®å½•
      </label>
      <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç­¾åˆ°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    è¿›åˆ¶åå…­â€”â€”å‚ä¸Š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å»å§ï¼è¿½å¯»è‡ªç”±çš„ç”µæ³¢
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pro-max" class="md-nav__link">
    çŒ«å’ªé—®ç­” Pro Max
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    å–ç“œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    é€æ˜çš„æ–‡ä»¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    æ—…è¡Œç…§ç‰‡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    FLAG åŠ©åŠ›å¤§çº¢åŒ…
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#amnesia" class="md-nav__link">
    Amnesia
  </a>
  
    <nav class="md-nav" aria-label="Amnesia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    è½»åº¦å¤±å¿†
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    å›¾ä¹‹ä¸Šçš„ä¿¡æ¯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easy-rsa" class="md-nav__link">
    Easy RSA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#u" class="md-nav__link">
    åŠ å¯†çš„ U ç›˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    èµ›åšå¨æˆ¿
  </a>
  
    <nav class="md-nav" aria-label="èµ›åšå¨æˆ¿">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#level-0" class="md-nav__link">
    Level 0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#level-1" class="md-nav__link">
    Level 1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#micro-world" class="md-nav__link">
    Micro World
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    é˜µåˆ—æ¢å¤å¤§å¸ˆ
  </a>
  
    <nav class="md-nav" aria-label="é˜µåˆ—æ¢å¤å¤§å¸ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raid-5" class="md-nav__link">
    RAID 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid-0" class="md-nav__link">
    RAID 0
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    åŠ©è®°è¯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    é©¬èµ›å…‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minecraft" class="md-nav__link">
    minecRaft
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    å¯†ç ç”Ÿæˆå™¨
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pq" class="md-nav__link">
    pğŸ˜­q
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
        
      </ul>
    
  </nav>
                      
                    </div>
                  </div>
                </div>
                
              
            
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
<a href="https://github.com/TonyCrane/note/tree/master/docs/writeups/hackergame2021.md" title="ç¼–è¾‘æ­¤é¡µ" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="hackergame-2021-writeup">Hackergame 2021 Writeup<a class="headerlink" href="#hackergame-2021-writeup" title="Permanent link">&para;</a></h1>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p>å‚åŠ çš„ç¬¬ä¸€ä¸ªå¯ä»¥ç®—æ˜¯ CTF çš„æ¯”èµ›ã€‚è¿™é‡Œæ˜¯æˆ‘åšå‡ºçš„é¢˜çš„ writeupï¼Œåšå®¢ç‰ˆåœ¨ï¼š<a href="https://blog.tonycrane.cc/p/c05d7b7c.html">https://blog.tonycrane.cc/p/c05d7b7c.html</a></p>
<p><a href="https://github.com/USTC-Hackergame/hackergame2021-writeups">å®˜æ–¹ writeup</a></p>
</div>
<hr />
<h2 id="_1">ç­¾åˆ°<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-WEB-blueviolet?style=flat-square" /></p>
<blockquote>
<p>ä¸ºäº†èƒ½è®©å¤§å®¶é¡ºåˆ©ç­¾åˆ°ï¼Œå‘½é¢˜ç»„æŠŠæ¯ä¸€ç§’çš„ flag éƒ½è®°å½•ä¸‹æ¥åˆ¶æˆäº†æ—¥è®°æœ¬çš„ä¸€é¡µã€‚ä½ åªéœ€è¦æ‰“å¼€æ—¥è®°ï¼Œç¿»åˆ° Hackergame 2021 æ¯”èµ›è¿›è¡ŒæœŸé—´çš„ä»»ä½•ä¸€é¡µå°±èƒ½å¾—åˆ° flagï¼</p>
</blockquote>
<p>å¾ˆæ˜ç¡®ï¼Œè¿›å…¥ç½‘å€åä¸€ç›´ç‚¹ Next ç¿»åˆ°æ¯”èµ›æ—¶é—´å°±å¥½äº†ï¼ˆè¯¯</p>
<p>çœ‹åˆ°äº† URI é‡Œæœ‰ <code>?page=...</code>ï¼Œæ‰€ä»¥ä¹Ÿæ‡’å¾—è®¡ç®—äº†ï¼Œæ‰‹åŠ¨äºŒåˆ†ï¼Œå¤§æ¦‚ <code>?page=1635000000</code> å·¦å³å°±å¯ä»¥çœ‹åˆ° flag äº†</p>
<p><del>èµ›åæ‰ååº”è¿‡æ¥åŸæ¥æ˜¯ UNIX æ—¶é—´æˆ³</del></p>
<hr />
<h2 id="_2">è¿›åˆ¶åå…­â€”â€”å‚ä¸Š<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<p><img alt="" src="/assets/images/writeups/hackergame2021/hex_editor.png" />
ä¹Ÿå¾ˆæ˜ç¡®ï¼Œç›´æ¥æŠŠå³ä¾§æŒ¡ä½çš„ flag éƒ¨åˆ†å¯¹åº”å·¦è¾¹çš„åå…­è¿›åˆ¶æ•°æ¢ç®—æˆåè¿›åˆ¶ï¼Œç„¶åæ ¹æ® ASCII ç è½¬æˆå­—ç¬¦ã€‚æˆ–è€…ç›´æ¥æŠŠå·¦ä¾§æŠ„è¿› Hex Friend ä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°å³ä¾§çš„flagã€‚</p>
<p>ï¼ˆ**å½“æ—¶è¿™é¢˜æŠ„ä¸²è¡Œäº†ä¸¤ä¸‰æ¬¡â€¦â€¦ï¼‰</p>
<hr />
<h2 id="_3">å»å§ï¼è¿½å¯»è‡ªç”±çš„ç”µæ³¢<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<blockquote>
<p>å½“ç„¶ï¼Œå¦‚æœåªæ˜¯è¿™æ ·è¿˜è¿œè¿œä¸å¤Ÿã€‚éµä¾å²ç§°â€œè€çˆ¹â€çš„ä¸Šå¤å…ˆè´¤çš„è‡³ç†åè¨€ï¼Œå¿…é¡»è¦â€œç”¨é­”æ³•æ‰“è´¥é­”æ³•â€ã€‚X åŒå­¦å‘ä¸Šçº§ç”³è¯·åˆ°äº†ç§‘å¤§è¥¿åŒºåŒæ­¥è¾å°„å®éªŒå®¤è®¾å¤‡çš„ä½¿ç”¨æƒé™ï¼Œä»¥æ­¤æ‰“é€šæ¬¡å…ƒç©ºé—´ï¼Œå€ŸåŠ©åˆ°å¦ä¸€ä¸ªå¹³è¡Œå®‡å®™ä¸­ Z åŒå­¦çš„æ³•åŠ›è¿›è¡Œæ•°æ®å¯¹å†²ï¼Œæ–¹æ‰äºä¹±ä¸­æå¾—ä¸€ä¸æœºä¼šï¼Œå°† flag ç”¨æ— çº¿ç”µçš„å½¢å¼å‘å°„äº†å‡ºå»ã€‚</p>
<p>è€ƒè™‘åˆ°ä¿¡æ¯çš„é²æ£’æ€§ï¼ŒX åŒå­¦ä½¿ç”¨äº†æ— çº¿ç”µä¸­æƒ¯ç”¨çš„æ–¹æ³•æ¥åŒºåˆ†å­—ç¬¦ä¸²ä¸­è¯»éŸ³ç›¸è¿‘çš„å­—æ¯ã€‚å³ä½¿å¦‚æ­¤ï¼Œæ‰“ç ´æ¬¡å…ƒçš„å¼ºå¤§èƒ½é‡æ‰­æ›²äº†æ—¶ç©ºï¼Œä½¿å¾—æœ€ç»ˆæ¥å—åˆ°çš„å½•éŸ³çš„é€Ÿåº¦æœ‰æ‰€æ”¹å˜ã€‚</p>
</blockquote>
<p>ï¼ˆè¿™é¢˜åœ¨ç¾¤é‡Œçœ‹èµ·æ¥å¥½åƒå¡äº†å¾ˆå¤šäººï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰<br/>
é¢˜ç›®ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªå¬èµ·æ¥æ‚ä¹±çš„éŸ³é¢‘</p>
<p>é¢˜é‡Œæœ€åè¯´äº† â€œæœ€ç»ˆæ¥å—åˆ°çš„å½•éŸ³çš„<strong>é€Ÿåº¦</strong>æœ‰æ‰€æ”¹å˜â€ï¼Œæ‰€ä»¥è€ƒè™‘å°†éŸ³é¢‘æ—¶é—´æ‹‰é•¿ã€‚<br/>
æœ€å¼€å§‹ä½¿ç”¨äº† Adobe Auditionï¼Œä½†æ˜¯æ•ˆæœä¸æ˜¯å¾ˆç†æƒ³ï¼Œå¤§æ¦‚æ˜¯é‡æ–°é‡‡æ ·ç­‰ä¸€ç³»åˆ—ç®—æ³•å¯¼è‡´çš„<br/>
æ‰€ä»¥æ¢äº† Adobe Premier Pro ç›´æ¥ç”¨æ¯”ç‡æ‹‰ä¼¸å·¥å…·æ‹‰é•¿éŸ³é¢‘ï¼Œè¿˜æ˜¯å¯ä»¥å¬æ¸…çš„<br/>
ä¸æ–­å°è¯•ä¹‹åï¼Œå¤§æ¦‚æ”¾æ…¢ä¸‰å€å·¦å³å°±å¯ä»¥å¬å‡ºè¯»çš„æ˜¯è‹±è¯­å•è¯äº†</p>
<p>é¢˜é‡Œè¯´åˆ°äº† â€œè€ƒè™‘åˆ°ä¿¡æ¯çš„é²æ£’æ€§ï¼ŒX åŒå­¦ä½¿ç”¨äº†<strong>æ— çº¿ç”µä¸­æƒ¯ç”¨çš„æ–¹æ³•</strong>æ¥åŒºåˆ†å­—ç¬¦ä¸²ä¸­è¯»éŸ³ç›¸è¿‘çš„å­—æ¯â€ï¼Œæ‰€ä»¥å°±æŸ¥åˆ°äº†<a href="https://zhuanlan.zhihu.com/p/101866561">å›½é™…èˆªç©ºæ— çº¿ç”µé€šè®¯26ä¸ªè‹±æ–‡å­—æ¯è¯»æ³•</a><br/>
ç„¶åä»”ç»†å¬ï¼Œè¾¨åˆ«æ¯ä¸ªå•è¯çš„ç¬¬ä¸€ä¸ªéŸ³å°±å¯ä»¥å¾—åˆ° flag äº†</p>
<hr />
<h2 id="pro-max">çŒ«å’ªé—®ç­” Pro Max<a class="headerlink" href="#pro-max" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<p>äº”é“åˆé’»çš„é¢˜ç›®ï¼Œä½†æ˜¯è¿˜æ˜¯å¥½æŸ¥åˆ°çš„ï¼Œé¢˜ç›®é‡Œä¹Ÿè¯´äº†â€œè§£å‡ºè°œé¢˜ä¸éœ€è¦æ˜¯ç§‘å¤§åœ¨æ ¡å­¦ç”Ÿâ€</p>
<blockquote>
<ol>
<li>2017 å¹´ï¼Œä¸­ç§‘å¤§ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨ï¼ˆSEC@USTCï¼‰å¹¶å…¥ä¸­ç§‘å¤§ Linux ç”¨æˆ·åä¼šï¼ˆUSTCLUGï¼‰ã€‚ç›®å‰ï¼Œä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨çš„åŸŸåï¼ˆsec.ustc.edu.cnï¼‰å·²ç»æ— æ³•è®¿é—®ï¼Œä½†ä½ èƒ½æ‰¾åˆ°ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨çš„ç¤¾å›¢ç« ç¨‹åœ¨å“ªä¸€å¤©çš„ä¼šå‘˜ä»£è¡¨å¤§ä¼šä¸Šé€šè¿‡çš„å—ï¼Ÿ</li>
</ol>
</blockquote>
<p>çœ‹åˆ°äº† â€œç›®å‰ï¼Œå·²ç»æ— æ³•è®¿é—®â€ è¯´æ˜è¿™ä¸ªåŸŸåæ›¾ç»æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œç›´æ¥é€šè¿‡ <del>äº’è”ç½‘çš„è®°å¿†</del> archive.orgï¼ŒæŸ¥åˆ°è¿™ä¸ªåŸŸåçš„å†å²å­˜æ¡£ï¼Œéšä¾¿æ‰¾ä¸€å¤©å°±å¯ä»¥çœ‹åˆ°ä»–ä»¬å®˜ç½‘ä¸­çš„<a href="https://web.archive.org/web/20170613090934/http://sec.ustc.edu.cn/doku.php/codes">ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨ç¤¾å›¢ç« ç¨‹</a>ã€‚<br/>
å…¶ä¸­ç¬¬ä¸€è¡Œå°±å†™äº† â€œæœ¬ç« ç¨‹åœ¨ <em>2015 å¹´ 5 æœˆ 4 æ—¥</em>ï¼Œç»ä¼šå‘˜ä»£è¡¨å¤§ä¼šå®¡è®®é€šè¿‡ã€‚â€</p>
<p>æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯ <strong>20150504</strong></p>
<blockquote>
<ol start="2">
<li>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ Linux ç”¨æˆ·åä¼šåœ¨è¿‘äº”å¹´å¤šå°‘æ¬¡è¢«è¯„ä¸ºæ ¡äº”æ˜Ÿçº§ç¤¾å›¢ï¼Ÿ</li>
</ol>
</blockquote>
<p>ç›´æ¥å»ç§‘å¤§ LUG å®˜ç½‘çš„ <a href="https://lug.ustc.edu.cn/wiki/intro/">Intro é¡µé¢</a>ï¼Œå°±å¯ä»¥çœ‹åˆ° â€œäº 2015 å¹´ 5 æœˆã€2017 å¹´ 7 æœˆã€2018 å¹´ 9 æœˆã€2019 å¹´ 8 æœˆåŠ 2020 å¹´ 9 æœˆè¢«è¯„ä¸ºä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦äº”æ˜Ÿçº§å­¦ç”Ÿç¤¾å›¢ã€‚â€<br/>
æ‰€ä»¥æ˜¯4æ¬¡ï¼ˆx <br/>
ä½†æ˜¯æ€€ç–‘ä¸€ä¸‹ä¸ºä»€ä¹ˆæ²¡æœ‰2021å¹´ï¼Œå› ä¸ºéƒ½æ˜¯åœ¨9æœˆä»½å·¦å³ï¼Œæ‰€ä»¥å¯èƒ½æ˜¯æ•°æ®æ²¡æ›´æ–°ï¼Œè¿™é¢˜4å’Œ5éƒ½æœ‰å¯èƒ½</p>
<p>å°è¯•åå¾—åˆ°ç­”æ¡ˆæ˜¯ <strong>5</strong></p>
<blockquote>
<ol start="3">
<li>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ Linux ç”¨æˆ·åä¼šä½äºè¥¿åŒºå›¾ä¹¦é¦†çš„æ´»åŠ¨å®¤é—¨å£çš„ç‰Œå­ä¸Šâ€œLUG @ USTCâ€ä¸‹æ–¹çš„å°å­—æ˜¯ï¼Ÿ</li>
</ol>
</blockquote>
<p>è¿™é¢˜ä¹Ÿç®€å•ï¼Œç›´æ¥é—®ç§‘å¤§åŒå­¦å°±å¥½äº†ï¼ˆx <br/>
ç¿»äº† LUG çš„å¾®ä¿¡å…¬ä¼—å·å’Œ QQ å®˜æ–¹å·ï¼Œéƒ½æ²¡å•¥æ”¶è·ï¼Œæœ€åå‘ç°å®˜ç½‘ä¸Šæœ‰ <a href="https://lug.ustc.edu.cn/news/">News</a>ã€‚è¿™æ ·çš„è¯ï¼Œå¦‚æœæ–°å¯ç”¨æ´»åŠ¨å®¤çš„è¯ï¼Œä¸€å®šä¼šæœ‰ä¸€ç¯‡æ–°é—»ç¨¿ï¼Œæœç´¢â€œå›¾ä¹¦é¦†â€å¾—åˆ°äº†<a href="https://lug.ustc.edu.cn/news/2016/06/new-activity-room-in-west-library/">ã€Œè¥¿åŒºå›¾ä¹¦é¦†æ–°æ´»åŠ¨å®¤å¯ç”¨ã€</a>è¿™ç¯‡æ–‡ç« ï¼Œå¼€ç¯‡ç¬¬ä¸€å¼ å¤§å›¾å°±æ˜¯é—¨å£ç‰Œå­çš„ç…§ç‰‡<br/></p>
<p>æ‰€ä»¥ç­”æ¡ˆæ˜¯ <strong>Development Team of Library</strong> ï¼ˆæ³¨æ„å¤§å°å†™ï¼‰</p>
<blockquote>
<ol start="4">
<li>åœ¨ SIGBOVIK 2021 çš„ä¸€ç¯‡å…³äºäºŒè¿›åˆ¶ Newcomb-Benford å®šå¾‹çš„è®ºæ–‡ä¸­ï¼Œä½œè€…ä¸€å…±å±•ç¤ºäº†å¤šå°‘ä¸ªæ•°æ®é›†å¯¹å…¶ç†è®ºç»“æœè¿›è¡ŒéªŒè¯ï¼Ÿ</li>
</ol>
</blockquote>
<p>åº”è¯¥æ²¡å¿…è¦æœè°·æ­Œå­¦æœ¯ä¹‹ç±»çš„ï¼Œç›´æ¥å¿…åº”æŸ¥ â€œSIGBOVIK Newcomb-Benfordâ€ å°±å¯ä»¥æ‰¾åˆ° SIGBOVIK çš„<a href="http://sigbovik.org/2021/proceedings.pdf">è¿™ä¸€ç¯‡å¤§æ–‡ç« åˆé›†</a>ï¼Œå†æœç´¢ Newcomb å°±å¯ä»¥çœ‹åˆ°é¢˜ç›®é‡Œè¯´çš„è®ºæ–‡äº†ã€‚<br/>
å…¨æ–‡ä¹Ÿä¸é•¿ï¼Œåªæœ‰å››é¡µï¼Œåä¸¤é¡µå…¨æ˜¯æ•°æ®çš„å›¾ï¼Œæ•°ä¸€ä¸‹ï¼Œä¸€å…±æœ‰13å¹…</p>
<p>æ‰€ä»¥ç­”æ¡ˆæ˜¯ <strong>13</strong></p>
<blockquote>
<ol start="5">
<li>ä¸ä¸¥æ ¼éµå¾ªåè®®è§„èŒƒçš„æ“ä½œç€å®ä»¤äººç”ŸåŒï¼Œå¥½åœ¨ IETF äº 2021 å¹´æˆç«‹äº† Protocol Police ä»¥ç›‘ç£å¹¶æƒ©æˆ’æ‰€æœ‰è¿èƒŒ RFC æ–‡æ¡£çš„è¡Œä¸ºä¸ªä½“ã€‚å‡å¦‚ä½ å‘ç°äº†æŸä½åŒå­¦å¯èƒ½è¿åäº†åè®®è§„èŒƒï¼Œæ ¹æ® Protocol Police ç›¸å…³æ–‡æ¡£ä¸­è§„å®šçš„ä¸¾æŠ¥æ–¹æ³•ï¼Œä½ åº”è¯¥å°†ä½ çš„ä¸¾æŠ¥ä¿¡å‘å¾€ä½•å¤„ï¼Ÿ</li>
</ol>
</blockquote>
<p>æ²¡å•¥å¥½è¯´çš„ï¼Œç›´æ¥æŸ¥ï¼Œç­”æ¡ˆ <strong>/dev/null</strong></p>
<p>ç„¶åæäº¤å°±å¯ä»¥å¾—åˆ° flag</p>
<hr />
<h2 id="_4">å–ç“œ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-WEB-blueviolet?style=flat-square" /></p>
<p>é¢˜ç›®é‡Œæ¯”è¾ƒé‡è¦çš„è¯å°±æ˜¯ï¼š</p>
<blockquote>
<p>è¡¥å……è¯´æ˜ï¼šå½“ç§°çš„æ•°å­—å˜ä¸ºæµ®ç‚¹æ•°è€Œä¸æ˜¯æ•´æ•°æ—¶ï¼ŒHQ ä¸ä¼šè®¤å¯æœ€ç»ˆçš„ç§°é‡ç»“æœã€‚</p>
</blockquote>
<p>é¢˜ç›®çš„ç›®çš„ä¹Ÿå¾ˆæ˜ç¡®ï¼Œç”¨ä¸€å †9å’Œä¸€å †6åŠ èµ·æ¥å¾—åˆ°20ã€‚è‚¯å®šä¸èƒ½ <del>åƒåå¼ºä¸€æ ·</del> åŠˆç“œï¼Œæ‰€ä»¥è¾“å…¥ä¸€å®šæ˜¯æ•´æ•°<br/>
é‚£å°±å¯ä»¥è€ƒè™‘æº¢å‡º<br/>
ä½†æ˜¯ç»è¿‡å°è¯•ï¼Œç»™çš„æ•°å­—å¤ªå¤§ï¼Œå°±ä¼šä½¿ç»“æœæº¢å‡ºåˆ°æµ®ç‚¹æ•°ï¼Œè¿™ä¸æ˜¯æƒ³è¦çš„ï¼ˆå› ä¸ºå³ä½¿å‡‘åˆ°äº†20.0ä¹Ÿä¸æ­£ç¡®ï¼‰</p>
<p>é‚£å¦‚æœæ•°å­—å†å¤§å‘¢ï¼Œæ¯”å¦‚ 2000000000000000000ï¼ˆ18ä¸ª0ï¼‰ä¸ª9æ–¤çš„ç“œï¼Œå¯ä»¥å‘ç°ï¼Œè¿™æ—¶ç›´æ¥æº¢å‡ºåˆ°äº†è´Ÿæ•´å‹ -446744073709551616<br/>
å†è¡¥ä¸Š 49638230412172000 ä¸ª9æ–¤çš„ç“œå°±å¯ä»¥å¾—åˆ° -3616ï¼ŒåŠ ä¸Š20å¯ä»¥è¢«6æ•´é™¤ï¼Œæ‰€ä»¥å†åŠ ä¸Š606ä¸ª6æ–¤çš„ç“œå°±å¯ä»¥å¾—åˆ° 20</p>
<p><del>æ­å–œä½ é€ƒè¿‡ä¸€åŠ«ï¼åå¼ºï½åå¼ºï¼</del></p>
<hr />
<h2 id="_5">é€æ˜çš„æ–‡ä»¶<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<blockquote>
<p>ä¸€ä¸ªé€æ˜çš„æ–‡ä»¶ï¼Œç”¨äºåœ¨ç»ˆç«¯ä¸­å±•ç¤ºä¸€ä¸ªäº”é¢œå…­è‰²çš„ flagã€‚</p>
<p>å¯èƒ½æ˜¯åœ¨ cmd.exe ç­‰åŠ£è´¨ç»ˆç«¯ä¸­è¢«é•¿æœŸä½¿ç”¨çš„åŸå› ï¼Œè¿™ä¸ªæ–‡ä»¶å¤±å»äº†ä¸€äº›é‡è¦æˆåˆ†ï¼Œå˜æˆäº†ä¸€å †ä¹±ç ï¼Œä¹Ÿä¸ä¼šå†æ˜¾ç¤ºå‡º flag äº†ã€‚</p>
<p>æ³¨æ„ï¼šflag å†…éƒ¨çš„å­—ç¬¦å…¨éƒ¨ä¸ºå°å†™å­—æ¯ã€‚</p>
</blockquote>
<p>æ‹¿åˆ°æ–‡ä»¶ï¼Œçœ‹åˆ°é‡Œé¢å¥½å¤š <code>[ ; m</code> ä¹‹ç±»çš„ï¼Œå†ç»“åˆç»ˆç«¯ä¸­è¾“å‡ºå¸¦é¢œè‰²æ–‡å­—çš„ <code>\033[...m;</code> ä¹‹ç±»çš„æ–¹æ³•ï¼Œä»¥åŠé¢˜ç›®ä¸­çš„ â€œå¤±å»äº†ä¸€äº›<strong>é‡è¦æˆåˆ†</strong>â€<br/>
æ‰€ä»¥ç›´æ¥å°è¯•æŠŠ <code>[</code> å…¨å±€æ›¿æ¢ä¸º <code>\033[</code>ï¼Œç„¶åå¤åˆ¶åˆ° python ä¸­ printï¼Œå°±å¯ä»¥çœ‹åˆ°ç¥å¥‡çš„ä¸€å¹•äº†ï¼ˆå…¶å®å¹¶æ²¡å®Œå…¨åšå®Œï¼Œä½†æ˜¯å¯ä»¥å·²ç»çœ‹äº†ï¼‰
<img alt="" src="/assets/images/writeups/hackergame2021/transparent.png" />
ç„¶åè¯»å‡º flag å³å¯ï¼ˆå…¨æ˜¯å°å†™å­—æ¯ï¼‰</p>
<hr />
<h2 id="_6">æ—…è¡Œç…§ç‰‡<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<blockquote>
<p>ä½ çš„å­¦é•¿å†³å®šæ¥ä¸€åœºè¯´èµ°å°±èµ°çš„æ—…è¡Œã€‚é€šè¿‡ä»–å‘ç»™ä½ çš„ç…§ç‰‡æ¥çœ‹ï¼Œä»–åº”è¯¥æ˜¯åœ¨é…’åº—ä½ä¸‹äº†ã€‚</p>
<p>ä»ç…§ç‰‡æ¥çœ‹ï¼Œé…’åº—ä¼¼ä¹åœ¨å°åŒºçš„ä¸€æ ‹é«˜æ¥¼é‡Œï¼Œé™„è¿‘è¿˜æœ‰ä¸€å®¶ KFC åˆ†åº—ã€‚çªç„¶ï¼Œä½ æ„è¯†åˆ°ç…§ç‰‡é‡Œé€éœ²å‡ºæ¥çš„ä¿¡æ¯æ¯”è¡¨é¢ä¸Šçœ‹èµ·æ¥çš„è¦å¤šã€‚</p>
<p>è¯·è§‚å¯Ÿç…§ç‰‡å¹¶ç­”å¯¹å…¨éƒ¨ 5 é“é¢˜ä»¥è·å– flagã€‚æ³¨æ„ï¼šå›¾ç‰‡æœªåœ¨å…¶ä»–åœ°æ–¹å…¬å¼€å‘å¸ƒè¿‡ï¼Œä¹Ÿæœªé‡‡å–ä»»ä½•éšå†™æªæ–½ï¼ˆé€šè¿‡æ‰‹æœºæ‹æ‘„å±å¹•äº¦å¯ç­”é¢˜ï¼‰ã€‚
<img alt="" src="/assets/images/writeups/hackergame2021/travel-photo.jpg" /></p>
</blockquote>
<p>â€œæ‰‹æœºæ‹æ‘„å±å¹•äº¦å¯ç­”é¢˜â€ï¼Œæ‰€ä»¥ç…§ç‰‡ä¸­æ²¡æœ‰ä»»ä½•åœ°å€çš„å…ƒä¿¡æ¯ï¼Œåªèƒ½é çœ‹å›¾<br/>
<strong>çº¿ç´¢</strong>ï¼šæµ·è¾¹ã€KFCã€é«˜æ¥¼ã€å¤§çŸ³å¤´ã€åœè½¦ä½</p>
<p>å…ˆçœ‹é‚£ä¸ªKFCï¼Œå¤§æ¦‚æ˜¯ä¸ªç½‘çº¢åº—ï¼Œæ‰€ä»¥æœç´¢ â€œç½‘çº¢ æµ·è¾¹ KFCâ€ï¼ŒæŸ¥åˆ°äº†ç§¦çš‡å²›ï¼Œè€Œä¸”ä¹Ÿæ˜¯æµ·è¾¹<br/>
å†è¿›ä¸€æ­¥çœ‹åœ°å›¾å’Œè¡—æ™¯åœ°å›¾å°±å¯ä»¥ç¡®å®šåœ°ç‚¹åœ¨ <strong>ç§¦çš‡å²›æ–°æ¾³æµ·åº•ä¸–ç•Œ</strong></p>
<p>ç„¶åæ˜¯5ä¸ªé—®é¢˜</p>
<blockquote>
<p>è¯¥ç…§ç‰‡æ‹æ‘„è€…çš„é¢æœæ–¹å‘ä¸ºï¼š</p>
</blockquote>
<p>æ ¹æ®åœ°å›¾ï¼Œå¯¹æ¯”ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°ï¼Œé¢æœæ–¹å‘æ˜¯ <strong>ä¸œå—</strong></p>
<blockquote>
<p>è¯¥ç…§ç‰‡çš„æ‹æ‘„æ—¶é—´å¤§è‡´ä¸ºï¼š</p>
</blockquote>
<p>æ ¹æ®é€‰é¡¹é‡Œçš„æ—¶é—´ï¼Œä¸‹åˆæ˜¯ä¸¤ç‚¹åŠå·¦å³ï¼Œè€Œåœ¨ä¸œåŒ—çš„ä¸¤ç‚¹åŠå·¦å³å…¶å®å’Œä¸­åˆå·®ä¸å¤šï¼Œå½±å­å’Œå…‰æ¸©ä¹Ÿä¸å¤ªåƒè¿™ä¸ªæ ·å­ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šæ—¶é—´å¤§è‡´æ˜¯ <strong>å‚æ™š</strong></p>
<blockquote>
<p>è¯¥ç…§ç‰‡çš„æ‹æ‘„è€…æ‰€åœ¨æ¥¼å±‚ä¸ºï¼š</p>
</blockquote>
<p>ä¸å¥½ç¡®å®šï¼Œä½†æ˜¯ç­”æ¡ˆå¯ä»¥äº¤å¾ˆå¤šæ¬¡ï¼Œæ‰€ä»¥ä»9å±‚å·¦å³ä¾æ¬¡è¯•å°±å¯ä»¥äº†ï¼Œæœ€åå¾—åˆ°æ¥¼å±‚æ˜¯ <strong>14</strong></p>
<blockquote>
<p>è¯¥ç…§ç‰‡å·¦ä¸Šè§’ KFC åˆ†åº—çš„ç”µè¯å·ç æ˜¯ï¼š</p>
</blockquote>
<p>ç›´æ¥ç”¨åœ°å›¾è½¯ä»¶æœ â€œç§¦çš‡å²›æ–°æ¾³ KFCâ€ å°±å¯ä»¥æŸ¥åˆ°é‚£å®¶åº—é“ºï¼Œä¹Ÿç»™äº†ç”µè¯ï¼Œæˆ–è€…æœç´¢ â€ç½‘çº¢ æµ·è¾¹ KFCâ€œ ä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°ç”µè¯ï¼š<strong>0335-7168800</strong></p>
<blockquote>
<p>è¯¥ç…§ç‰‡å·¦ä¸Šè§’ KFC åˆ†åº—å·¦ä¾§å»ºç­‘æœ‰ä¸‰ä¸ªæ°´å¹³æ’åˆ—çš„æ±‰å­—ï¼Œå®ƒä»¬æ˜¯ï¼š</p>
</blockquote>
<p>é€šè¿‡è¡—æ™¯åœ°å›¾å°±å¯ä»¥çœ‹åˆ° KFC å·¦è¾¹çš„å»ºç­‘ä¸Šå†™äº† <strong>æµ·è±šé¦†</strong></p>
<hr />
<h2 id="flag">FLAG åŠ©åŠ›å¤§çº¢åŒ…<a class="headerlink" href="#flag" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-WEB-blueviolet?style=flat-square" /></p>
<blockquote>
<p>å‚ä¸æ´»åŠ¨ï¼ŒåŠ©åŠ›æŠ½å¥–ï¼é›†æ»¡ 1 ä¸ª flagï¼Œå³å¯æå– 1 ä¸ª flagã€‚</p>
<p>æ­å–œä½ ç§¯æ”’åˆ° 0.5â€¦â€¦ ä¸ª flagï¼Œ 
å‰©ä½™æ—¶é—´ï¼š10åˆ†00ç§’</p>
<p>å·²æœ‰ 0 ä½å¥½å‹ä¸ºæ‚¨åŠ©åŠ›ã€‚</p>
<p>å°†å¦‚ä¸‹é“¾æ¥åˆ†äº«ç»™å¥½å‹ï¼Œå¯ä»¥è·å¾—å¥½å‹åŠ©åŠ›ï¼Œè·å¾—æ›´å¤š flagï¼šâ€¦â€¦</p>
</blockquote>
<p><del>è€å¹¶å¤•å¤•äº†</del>ï¼Œç»è¿‡ä¸€äº›æµ‹è¯•å’Œçœ‹è§„åˆ™å¯ä»¥çŸ¥é“ï¼Œip åœ¨åŒä¸€ /8 ç½‘æ®µçš„ç”¨æˆ·è¢«è§†ä¸ºåŒä¸€ç”¨æˆ·ï¼Œå³ ip åœ°å€çš„ç¬¬ä¸€ä¸ªç‚¹å‰é¢çš„æ•°å­—ä¸ä¸€æ ·æ‰æ˜¯ä¸åŒç”¨æˆ·<br/>
å†ç”¨è™šæ‹Ÿæœºå’Œæ‰‹æœºè¯•ä¸€ä¸‹ï¼Œå‘ç°æ¯ä¸ªç”¨æˆ·å¢åŠ çš„ flag æ•°é‡å¾ˆå°<br/>
æ‰€ä»¥æ¨æµ‹éœ€è¦200+ä¸ª ip åœ°å€ï¼Œè‚¯å®šä¸ä¼šè¦çœŸçš„è½¬å‘ï¼Œè€Œä¸”ä¹Ÿå¾ˆéš¾å‡‘å‡ºå¾ˆå¤šä¸åœ¨åŒä¸€ /8 ç½‘æ®µçš„ ip</p>
<p>äºæ˜¯åœ¨ BurpSuite é‡Œé¢æŠ“åŒ…å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡ç‚¹å‡»â€œåŠ©åŠ›â€éƒ½ä¼šå‘é€ä¸€ä¸ªåˆ°åŠ©åŠ›é“¾æ¥çš„ POSTï¼Œå†…å®¹ä¸º ip åœ°å€
<img alt="" src="/assets/images/writeups/hackergame2021/burp.png" />
ç„¶åå°†å…¶å‘é€åˆ° Repeater ä¸­ï¼Œå°è¯•æ›´æ”¹ ip åœ°å€ï¼Œå¾—åˆ°çš„ Response ä¸­è¯´ â€œå¤±è´¥ï¼æ£€æµ‹åˆ°å‰åç«¯æ£€æµ‹ IPv4 åœ°å€ä¸åŒ¹é…â€</p>
<p>æ‰€ä»¥ä»…ä»…æ›´æ”¹ POST å†…å®¹çš„ ip æ˜¯ä¸å¤Ÿçš„ï¼Œè€Œæä¾›ç»™æ£€æµ‹çš„å†…å®¹ä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ª POSTï¼Œæ‰€ä»¥å¯ä»¥æ›´æ”¹ POST å¤´ï¼Œæ·»åŠ  <strong>X-Forwarded-For</strong><br/>
ç„¶åä½¿ç”¨ python å°±å¯ä»¥å¾ªç¯å‘é€ POST å¹¶ä¼ªé€  ip åœ°å€å¾—åˆ°256ä¸ªåŠ©åŠ›äº†ï¼Œåˆšå¥½è¾¾åˆ°1ä¸ªflagï¼š<br/>
ï¼ˆè¦æ³¨æ„ sleep ä¸€æ®µæ—¶é—´ï¼Œä¸ç„¶ä¼šå‡ºç°æ“ä½œè¿‡å¿«æ‹’ç»çš„æƒ…å†µï¼›ä¹Ÿä¸è¦ sleep è¿‡é•¿ï¼Œå¦åˆ™è¶…è¿‡10åˆ†é’Ÿ flag å°±æ— æ•ˆäº†ï¼‰
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">requests</span> 
<a id="__codelineno-0-2" name="__codelineno-0-2" href="__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="__codelineno-0-3"></a><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="__codelineno-0-5"></a><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://202.38.93.111:10888/invite/...&quot;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="__codelineno-0-7"></a><span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="__codelineno-0-8"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="__codelineno-0-9"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.0.0.0&quot;</span><span class="p">},</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X-Forwarded-For&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.0.0.0&quot;</span><span class="p">})</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="__codelineno-0-10"></a>        <span class="k">if</span> <span class="s2">&quot;æˆåŠŸ&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="__codelineno-0-11"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[x] å¤±è´¥&quot;</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="__codelineno-0-12"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="__codelineno-0-13"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="__codelineno-0-14"></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></p>
<hr />
<h2 id="amnesia">Amnesia<a class="headerlink" href="#amnesia" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-REVERSE-inactive?style=flat-square" /></p>
<h3 id="_7">è½»åº¦å¤±å¿†<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<blockquote>
<p>ä½ çš„ç¨‹åºåªéœ€è¦è¾“å‡ºå­—ç¬¦ä¸² Hello, world!ï¼ˆç»“å°¾æœ‰æ— æ¢è¡Œå‡å¯ï¼‰å¹¶æ­£å¸¸ç»“æŸã€‚</p>
<p>ç¼–è¯‘æŒ‡ä»¤ï¼š<code>gcc -O file.c -m32</code></p>
<p>è¿è¡ŒæŒ‡ä»¤ï¼š<code>./a.out</code></p>
<p>ç¼–è¯‘å ELF æ–‡ä»¶çš„ .data å’Œ .rodata æ®µä¼šè¢«æ¸…é›¶ã€‚</p>
</blockquote>
<p>ELFï¼ˆExecutable and Linkable Formatï¼‰æ˜¯ Linux ä¸‹å¸¸ç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼Œå…¶ä¸­æœ‰å¾ˆå¤šä¸åŒçš„èŠ‚ï¼š</p>
<ul>
<li><code>.text</code> èŠ‚ï¼šç¨‹åºè¿è¡Œéœ€è¦çš„ä»£ç </li>
<li><code>.data</code> èŠ‚ï¼šå­˜æ”¾å¯ä¿®æ”¹çš„æ•°æ®ï¼Œä¸€èˆ¬æ˜¯é const å…¨å±€å˜é‡å’Œé™æ€å˜é‡</li>
<li><code>.rodata</code> èŠ‚ï¼šå³ read only dataï¼Œä¸€èˆ¬æ˜¯å¸¸é‡æˆ–è€…å­—ç¬¦ä¸²</li>
<li><code>.bss</code> èŠ‚ï¼šæ²¡æœ‰è¢«åˆå§‹åŒ–çš„å˜é‡</li>
<li>â€¦â€¦</li>
</ul>
<p>è€Œè¿™é“é¢˜ç›®åˆ™æ˜¯åœ¨ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ a.out åï¼Œæ¸…ç©º .data å’Œ .rodata<br/>
é¦–å…ˆä¸å¦¨æ­£å¸¸ç¼–å†™ä¸€ä¸ªè¾“å‡º â€œHello, world!â€ çš„ç¨‹åºï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="__codelineno-1-1"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello, world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
ç„¶åç¼–è¯‘ï¼Œå†æ‹–åˆ° IDA é‡Œ 
<img alt="" src="/assets/images/writeups/hackergame2021/amn1.png" />
å¯ä»¥å‘ç°ï¼Œæ­¤æ—¶çš„ "Hello, world!" è¢«æ”¾åˆ°äº† .rodata èŠ‚ä¸­ï¼Œä¼šè¢«æ¸…é™¤æ‰ï¼Œæ‰€ä»¥è¿™æ ·å†™ä¸è¡Œ</p>
<p>ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²ä¼šè¢«æ”¾åˆ° .rodata ä¸­æ¸…é™¤ï¼Œå†™æˆå…¨å±€å˜é‡åˆä¼šæ”¾åˆ° .data ä¸­<br/>
ä½†æ˜¯ï¼Œå¦‚æœå†™æˆå±€éƒ¨å˜é‡å‘¢ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="__codelineno-2-1"></a><span class="kt">char</span><span class="w"> </span><span class="n">str</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello, world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="__codelineno-2-2"></a><span class="n">printf</span><span class="p">(</span><span class="n">str</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
ç¼–è¯‘ï¼Œæ‹–åˆ° IDA é‡Œ
<img alt="" src="/assets/images/writeups/hackergame2021/amn2.png" />
å¯ä»¥çœ‹å‡ºï¼Œè¿™æ¬¡çš„å­—ç¬¦ä¸²ç›´æ¥å†™åˆ°äº† .text èŠ‚ä¸­ï¼Œåˆ æ‰äº† .data .rodata ä¹Ÿæ²¡æœ‰å½±å“<br/>
æ‰€ä»¥æŠŠè¿™ä¸ªä»£ç äº¤ä¸Šå»å°±å¯ä»¥è¾“å‡º â€œHello, world!â€œ æ‹¿åˆ° flag äº† </p>
<p>æ¸…é™¤è®°å¿†ç›´æ¥æŠŠ .text èŠ‚å…¨åˆ æ‰äº†ï¼Œæƒ³äº†å¾ˆä¹…ä¹Ÿä¸çŸ¥é“å’‹æï¼Œè™½ç„¶å¯ä»¥ __attribute__ ((section ("..."))) æ¥æŠŠå‡½æ•°æˆ–å˜é‡å¡åˆ°æŒ‡å®šçš„èŠ‚ä¸­ã€‚ä½†è¿˜æ˜¯ä¸æ¸…æ¥šè¦æ€ä¹ˆè§£å†³æ®µé”™è¯¯çš„é—®é¢˜qwq </p>
<hr />
<h2 id="_8">å›¾ä¹‹ä¸Šçš„ä¿¡æ¯<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-WEB-blueviolet?style=flat-square" /></p>
<blockquote>
<p>å° T å¬è¯´ GraphQL æ˜¯ä¸€ç§ç‰¹åˆ«çš„ API è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯ RESTful API çš„æœ‰åŠ›ç«äº‰è€…ï¼Œæ‰€ä»¥ä»–å†™äº†ä¸ªå°ç½‘ç«™æ¥å®éªŒè¿™é¡¹æŠ€æœ¯ã€‚</p>
<p>ä½ èƒ½é€šè¿‡è¿™ä¸ªå…¨æ–°çš„æ¥å£ï¼Œè·å–åˆ°æ²¡æœ‰å…¬å¼€å‡ºæ¥çš„ç®¡ç†å‘˜çš„é‚®ç®±åœ°å€å—ï¼Ÿ</p>
</blockquote>
<p>é¢˜ç›®ä¿¡æ¯ç»™çš„å¾ˆå……åˆ†ï¼Œç”¨çš„æ˜¯ GraphQLï¼Œè¦ç”¨å…¶å¾—åˆ° admin çš„é‚®ç®±</p>
<p>æ²¡æ¥è§¦è¿‡ GraphQLï¼Œæ‰€ä»¥ç›´æ¥å¿…åº”ï¼ˆé€ƒ<br/>
æŸ¥åˆ°äº†å¾ˆå¤šæœ‰ç”¨çš„ä¸œè¥¿ï¼š</p>
<ul>
<li><a href="https://graphql.cn/">GraphQLå®˜ç½‘</a>ï¼šäº†è§£ä¸€ä¸‹ GraphQL æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œè¦æ€ä¹ˆç”¨</li>
<li><a href="https://www.electronjs.org/apps/graphiql">GraphiQL</a>ï¼šä¸€ä¸ªè¿›è¡Œ GraphQL æŸ¥è¯¢çš„ GUI</li>
<li><a href="https://zhuanlan.zhihu.com/p/390876937">ã€å®‰å…¨è®°å½•ã€‘ç©è½¬GraphQL - DVGAé¶åœºï¼ˆä¸Šï¼‰- çŸ¥ä¹</a></li>
<li><a href="https://apis.guru/graphql-voyager/">GraphQL Voyager</a>ï¼šå¯è§†åŒ–ç°å® GraphQL å†…çœå‡ºçš„ç»“æ„</li>
</ul>
<p>ç®€è€Œè¨€ä¹‹ï¼ŒGraphQL å°±æ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡ä¸€æ¬¡ query è¯·æ±‚æŸ¥è¯¢å¤šä¸ªèµ„æºçš„ API æ¨¡å¼ï¼Œåªè¦ <code>ç½‘å€/graphql?query=...</code> å°±å¯ä»¥å®ç°æŸ¥è¯¢<br/>
æœ‰äº›ä½¿ç”¨ GraphQL çš„ç½‘ç«™å¯ä»¥ç›´æ¥é€šè¿‡è®¿é—® <code>ç½‘å€/graphiql</code> å¾—åˆ°æŸ¥è¯¢çš„ GUI<br/>
ä½†æ˜¯æœ¬é¢˜ä¸­ç¦æ­¢äº†ï¼Œä½†å¯ä»¥ä½¿ç”¨ GraphiQL è½¯ä»¶æ¥è¿›è¡ŒæŸ¥è¯¢</p>
<p>åœ¨ç¬¬ä¸‰ä¸ªé“¾æ¥ä¸­å¯ä»¥äº†è§£åˆ°ï¼Œå¯ä»¥åˆ©ç”¨ GraphQL çš„å†…çœæŸ¥è¯¢æ¥æ³„éœ²å‡ºå†…éƒ¨çš„ç»“æ„ï¼ŒæŠŠå…¶ä¸­çš„æŸ¥è¯¢è¯­å¥ä¸¢åˆ° GraphiQL ä¸­å¯ä»¥å¾—åˆ°ç»“æœ
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="__codelineno-3-1"></a>query IntrospectionQuery { __schema { queryType { name } mutationType { name } subscriptionType { name } types { ...FullType } directives { name description locations args { ...InputValue } } }}fragment FullType on __Type { kind name description fields(includeDeprecated: true) { name description args { ...InputValue } type { ...TypeRef } isDeprecated deprecationReason } inputFields { ...InputValue } interfaces { ...TypeRef } enumValues(includeDeprecated: true) { name description isDeprecated deprecationReason } possibleTypes { ...TypeRef }}fragment InputValue on __InputValue { name description type { ...TypeRef } defaultValue}fragment TypeRef on __Type { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name } } } } } } }}
</code></pre></div>
<img alt="" src="/assets/images/writeups/hackergame2021/graphiql.png" /></p>
<p>ç„¶åæŠŠç»“æœä¸¢åˆ° GraphQL Voyager ä¸­å°±å¯ä»¥å¾—åˆ°å¯è§†åŒ–çš„ç»“æ„ï¼š
<img alt="" src="/assets/images/writeups/hackergame2021/graphql.png" /></p>
<p>æ‰€ä»¥åªéœ€è¦æ ¹æ® id query ä¸€ä¸‹ user å°±å¯ä»¥äº†ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="__codelineno-4-1"></a><span class="n">query</span> <span class="p">{</span> <span class="n">user</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="n">privateEmail</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="__codelineno-4-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">{</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="__codelineno-4-4"></a>  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="__codelineno-4-5"></a>    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="__codelineno-4-6"></a>      <span class="s2">&quot;privateEmail&quot;</span><span class="p">:</span> <span class="s2">&quot;flag{...}&quot;</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="__codelineno-4-7"></a>    <span class="p">}</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="__codelineno-4-8"></a>  <span class="p">}</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="__codelineno-4-9"></a><span class="p">}</span>
</code></pre></div></p>
<hr />
<h2 id="easy-rsa">Easy RSA<a class="headerlink" href="#easy-rsa" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-CRYPTO-orange?style=flat-square" /></p>
<blockquote>
<p>è‡ªä» Hackergame 2018 å…¬ç„¶æ­éœ²äº†å¤§æ•´æ•°å¯ä»¥è¢«ç¥ç«¥å£ç®—åˆ†è§£çš„äº‹å®ï¼ŒRSA åœ¨ hackergame ä¸­å·²ç»åªèƒ½å¤„äºä½åˆ†å€¼çš„åœ°ä½äº†ã€‚å¦‚æœä¸åœ¨å…¶åç§°å‰é¢åŠ ä¸Š Easy è¿™ä¸ªå•è¯ï¼Œä¼¼ä¹å°±ä¼šæ˜¾å¾—å®Œå…¨å¯¹ä¸èµ·å…¶ä»–é¢˜ç›®ã€‚</p>
<p>æ›´ä½•å†µï¼Œåœ¨æœ¬é¢˜çš„é™„ä»¶ä¸­ï¼Œä½ è¿˜è·å¾—äº†æ„é€  p å’Œ q çš„æ–¹å¼ã€‚æ•°ç†åŸºç¡€æ‰å®çš„ä½ åº”è¯¥å¯ä»¥è½»æ¾è§£å†³è¿™äº›é—®é¢˜å§ã€‚</p>
</blockquote>
<p><del>è°¢é‚€ï¼Œæ²¡æœ‰æ•°ç†åŸºç¡€</del></p>
<p>çœ‹ä»£ç ï¼
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="__codelineno-5-1"></a><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="__codelineno-5-3"></a><span class="k">def</span> <span class="nf">get_p</span><span class="p">():</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="__codelineno-5-4"></a>    <span class="n">x</span> <span class="o">=</span> <span class="mi">11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391760451</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="__codelineno-5-5"></a>    <span class="n">y</span> <span class="o">=</span> <span class="mi">11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391661439</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="__codelineno-5-6"></a>    <span class="n">value_p</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># Hintï¼šè¿™é‡Œç›´æ¥è®¡ç®—ä¼šæº¢å‡ºï¼Œè¯·ä½ ä»”ç»†è§‚å¯Ÿ x å’Œ y çš„ç‰¹å¾</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="__codelineno-5-7"></a>    <span class="k">return</span> <span class="n">value_p</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="__codelineno-5-8"></a>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="__codelineno-5-9"></a><span class="k">def</span> <span class="nf">get_q</span><span class="p">():</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="__codelineno-5-10"></a>    <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">getPrime</span><span class="p">(</span><span class="mi">256</span><span class="p">)]</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="__codelineno-5-11"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="__codelineno-5-12"></a>        <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="__codelineno-5-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;value[-1] = &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="__codelineno-5-14"></a>    <span class="c1"># value[-1] = 80096058210213458444437404275177554701604739094679033012396452382975889905967</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="__codelineno-5-15"></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="__codelineno-5-16"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="__codelineno-5-17"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="__codelineno-5-18"></a>    <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="__codelineno-5-19"></a>    <span class="n">value_q</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="__codelineno-5-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;value_q = &quot;</span><span class="p">,</span> <span class="n">value_q</span><span class="p">)</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="__codelineno-5-21"></a>    <span class="c1"># value_q = 5591130088089053683141520294620171646179623062803708281023766040254675625012293743465254007970358536660934858789388093688621793201658889399155357407224541324547522479617669812322262372851929223461622559971534394847970366311206823328200747893961649255426063204482192349202005330622561575868946656570678176047822163692259375233925446556338917358118222905050574458037965803154233167594946713038301249145097770337253930655681648299249481985768272321820718607757023350742647019762122572886601905212830744868048802864679734428398229280780215896045509020793530842541217790352661324630048261329493088812057300480085895399922301827190211956061083460036781018660201163819104150988531352228650991733072010425499238731811243310625701946882701082178190402011133439065106720309788819</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="__codelineno-5-22"></a>    <span class="k">return</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="__codelineno-5-23"></a>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="__codelineno-5-24"></a><span class="c1"># this destroyes the rsa cryptosystem</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="__codelineno-5-25"></a><span class="n">p</span> <span class="o">=</span> <span class="n">get_p</span><span class="p">()</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="__codelineno-5-26"></a><span class="n">q</span> <span class="o">=</span> <span class="n">get_q</span><span class="p">()</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="__codelineno-5-27"></a>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="__codelineno-5-28"></a><span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;flag.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s2">&quot;big&quot;</span><span class="p">)</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="__codelineno-5-29"></a><span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="__codelineno-5-30"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c = &quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="__codelineno-5-31"></a><span class="c1"># c = 110644875422336073350488613774418819991169603750711465190260581119043921549811353108399064284589038384540018965816137286856268590507418636799746759551009749004176545414118128330198437101472882906564195341277423007542422286760940374859966152871273887950174522820162832774361714668826122465471705166574184367478</span>
</code></pre></div>
å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­è¦è§£å†³çš„å°±æ˜¯ <code>get_p()</code> ä¸­ y! % x æº¢å‡ºçš„é—®é¢˜ï¼Œä»¥åŠ <code>get_q()</code> ä¸­ q æ˜¯å“ªä¸ªéšæœºçš„512ä½è´¨æ•°çš„é—®é¢˜</p>
<p><strong>get_p</strong>:</p>
<p>ä»£ç é‡Œä¹Ÿç»™äº† Hintï¼Œè§‚å¯Ÿ x å’Œ y çš„ç‰¹å¾ã€‚x å’Œ y éƒ½å¾ˆå¤§ï¼Œä½†æ˜¯ä¸¤ä¸ªçš„å·®å¹¶ä¸å¤§ï¼›è€Œä¸”å¯ä»¥ä¸¢åˆ° python é‡ŒéªŒè¯å‡º x æ˜¯ä¸€ä¸ªè´¨æ•°<br/>
æ‰€ä»¥å¯ä»¥ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Wilson's_theorem"><strong>å¨å°”é€Šå®šç†</strong></a><br/>
ä¹ŸæŸ¥åˆ°äº†å¨å°”é€Šå®šç†åœ¨ RSA é¢˜ç›®ä¸­çš„åº”ç”¨ï¼š<a href="https://blog.csdn.net/xiao_han_a/article/details/118974504">BUU-RSA [RoarCTF2019]babyRSA</a></p>
<p>è¦æ±‚ y! % xï¼ˆxæ˜¯è´¨æ•°ï¼‰<br/>
æ ¹æ®å¨å°”é€Šå®šç†ï¼Œæœ‰</p>
<div class="arithmatex">\[
(x - 1)! \equiv -1\pmod{x}
\]</div>
<p>æ‰€ä»¥ï¼š</p>
<div class="arithmatex">\[
y!\times \frac{(x - 1)!}{y!}\equiv -1\pmod{x}
\]</div>
<p>ä»¤ <span class="arithmatex">\(k = \dfrac{(x - 1)!}{y!} = (y+1)(y+2)...(x-1)x\)</span> ï¼Œæ‰€ä»¥æœ‰ï¼š</p>
<div class="arithmatex">\[
y!\equiv -\mathrm{inv}(k, x)\pmod{x}
\]</div>
<p>ï¼ˆå…¶ä¸­ <span class="arithmatex">\(\mathrm{inv}(k, x)\)</span> è¡¨ç¤ºæ¨¡ x ä¸‹ k çš„é€†å…ƒï¼‰<br/>
æ‰€ä»¥é‡å†™ get_p() å³å¯æ­£ç¡®çš„å¾—åˆ° pï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="__codelineno-6-1"></a><span class="k">def</span> <span class="nf">get_p</span><span class="p">():</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="__codelineno-6-2"></a>    <span class="n">x</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="__codelineno-6-3"></a>    <span class="n">y</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="__codelineno-6-4"></a>    <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="__codelineno-6-5"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="__codelineno-6-6"></a>        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">x</span> 
<a id="__codelineno-6-7" name="__codelineno-6-7" href="__codelineno-6-7"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="o">%</span> <span class="n">x</span> 
<a id="__codelineno-6-8" name="__codelineno-6-8" href="__codelineno-6-8"></a>    <span class="k">return</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>get_q</strong>:</p>
<p>ç›¸æ¯”æ¥è¯´ï¼Œget_q å°±æ²¡é‚£ä¹ˆéœ€è¦æŠ€å·§äº†<br/>
ç»™å‡ºäº† value[-1] çš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨ <code>sympy.prevprime</code> é€†æ¨å‡ºæ•´ä¸ª value æ•°ç»„
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="__codelineno-7-1"></a><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">80096058210213458444437404275177554701604739094679033012396452382975889905967</span><span class="p">]</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="__codelineno-7-2"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="__codelineno-7-3"></a>    <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">prevprime</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="__codelineno-7-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;value[-1] = &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></p>
<p>åé¢è®¡ç®— value_q ç»†çœ‹å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ª RSA ç®—æ³•ï¼š</p>
<ul>
<li>qï¼šå¯†æ–‡</li>
<li>eï¼šç§é’¥</li>
<li>value_qï¼šæ˜æ–‡</li>
<li>nï¼šå°±æ˜¯ nï¼Œåªä¸è¿‡ä¸æ˜¯ä¸¤ä¸ªè´¨æ•°ç›¸ä¹˜ï¼Œæ˜¯åä¸ªè´¨æ•°ç›¸ä¹˜ </li>
</ul>
<p>åä¸ªè´¨æ•°ç›¸ä¹˜å¾—åˆ° n çš„ RSA ç®—æ³•ä¹Ÿä¸€æ ·ï¼Œå› ä¸º RSA çš„æ­£ç¡®æ€§å¹¶æ²¡æœ‰è¦æ±‚ n ä¸€å®šæ˜¯ä¸¤ä¸ªå¤§è´¨æ•°ç›¸ä¹˜ï¼Œè¿™æ ·åªæ˜¯éš¾ä»¥ç ´è§£ä¿è¯å®‰å…¨æ€§<br/>
è§£å†³è¿™ä¸ªåŒæ ·ä¹Ÿæ˜¯éœ€è¦å…¬é’¥ dï¼Œæ‰€ä»¥éœ€è¦ phi(n)<br/>
æ ¹æ®<a href="https://en.wikipedia.org/wiki/Euler%27s_totient_function">æ¬§æ‹‰å‡½æ•°</a>çš„æ€§è´¨ï¼Œphi(n) ç­‰äº n çš„æ‰€æœ‰è´¨å› æ•°å‡ä¸€çš„ç§¯<br/>
å³ phi(n) = (value[0] - 1) * (value[1] - 1) * ... * (value[9] - 1)</p>
<p>å†è§£å¯†å³å¯å¾—åˆ°å¯†æ–‡ qï¼Œç„¶åä¹Ÿå°±å¾—åˆ°äº† get_q çš„ç»“æœ</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="__codelineno-8-1"></a><span class="n">n</span> <span class="o">=</span> <span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="__codelineno-8-2"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="__codelineno-8-3"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="__codelineno-8-4"></a>    <span class="n">phi</span> <span class="o">*=</span> <span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="__codelineno-8-5"></a>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="__codelineno-8-6"></a><span class="n">value_q</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="__codelineno-8-7"></a><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> 
<a id="__codelineno-8-8" name="__codelineno-8-8" href="__codelineno-8-8"></a><span class="n">q</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">value_q</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="__codelineno-8-9"></a><span class="k">return</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</code></pre></div>
<p><strong>flag</strong>:</p>
<p>æå®šäº† get_p å’Œ get_q ä¹‹åå°±å¯ä»¥ç›´æ¥è§£å‡º flag äº†ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="__codelineno-9-1"></a><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="__codelineno-9-2"></a><span class="n">p</span> <span class="o">=</span> <span class="n">get_p</span><span class="p">()</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="__codelineno-9-3"></a><span class="n">q</span> <span class="o">=</span> <span class="n">get_q</span><span class="p">()</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="__codelineno-9-5"></a><span class="n">c</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="__codelineno-9-6"></a><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="__codelineno-9-7"></a><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="__codelineno-9-9"></a><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">))</span>
</code></pre></div></p>
<hr />
<h2 id="u">åŠ å¯†çš„ U ç›˜<a class="headerlink" href="#u" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<p>ï¼ˆæœ¬æ¥æŒºå¥½åšçš„ä¸€é“é¢˜ï¼Œæ€ä¹ˆé¢˜ç»™çš„æç¤ºæˆ‘å°±ç¡¬æ˜¯æ²¡é¢†ä¼šåˆ°ï¼‰</p>
<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªå…³äº LUKS (Linux Unified Key Setup) çš„æ•…äº‹ã€‚</p>
<p>ç¬¬ä¸€å¤©<br/>
å° Tï¼šã€Œä½ è¦çš„éšæœºè¿‡ç¨‹çš„è¯¾ä»¶æˆ‘å¸®ä½ æ‹·å¥½äº†ï¼Œåœ¨è¿™ä¸ª U ç›˜é‡Œï¼ŒLUKS åŠ å¯†çš„å¯†ç æ˜¯ suijiguocheng123123ã€‚ã€<br/>
å° Zï¼šã€Œå•Šï¼Œä½ åˆæäº† Linux æ–‡ä»¶ç³»ç»ŸåŠ å¯†ï¼ŒçœŸæ‹¿ä½ æ²¡åŠæ³•ã€‚æˆ‘ç°åœ¨ä¸æ–¹ä¾¿ç”¨ Linuxï¼Œæˆ‘ç›´æ¥æŠŠè¿™å—ç›˜åšæˆç£ç›˜é•œåƒæ–‡ä»¶å†å›å»å¤„ç†å§ã€‚ã€</p>
<p>ç¬¬äºŒå¤©<br/>
å° Zï¼šã€Œè°¢è°¢ä½ æ˜¨å¤©å¸®æˆ‘æ‹·çš„è¯¾ä»¶ã€‚ä½ æ¯æ¬¡éƒ½æè¿™ä¸ªåŠ å¯†ï¼Œå®ƒçœŸçš„å®‰å…¨å—ï¼Ÿã€<br/>
å° Tï¼šã€Œå½“ç„¶äº†ï¼ä½ çœ‹ï¼Œä½ è¿˜ç»™æˆ‘ä¹‹åï¼Œæˆ‘å·²ç»æŠŠè¿™å—ç›˜çš„å¼±å¯†ç æ”¹æ‰äº†ï¼Œç°åœ¨æ˜¯éšæœºç”Ÿæˆçš„å¼ºå¯†ç ï¼Œè¿™æ ·é™¤äº†æˆ‘è‡ªå·±ï¼Œä¸–ç•Œä¸Šä»»ä½•äººéƒ½æ— æ³•è§£å¯†å®ƒäº†ã€‚ã€<br/>
å° Zï¼šã€Œæˆ‘å¯ä¸ä¿¡ã€‚ã€<br/>
å° Tï¼šã€Œä½ ä¸ä¿¡ï¼Ÿä½ çœ‹ï¼Œæˆ‘ç°åœ¨å¾€ U ç›˜é‡Œæ”¾ä¸€ä¸ª flag æ–‡ä»¶ï¼Œç„¶åè¿™ä¸ª U ç›˜å°±ç»™ä½ äº†ï¼Œä½ ç»å¯¹è§£å¯†ä¸å‡ºæ¥è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚å½“åˆæ LUKS çš„æ—¶å€™æˆ‘å¯ç ”ç©¶äº†å¥½å‡ å¤©ï¼Œç­ä¸Šå¯æ²¡äººæ¯”æˆ‘æ›´æ‡‚åŠ å¯†ï¼ã€</p>
</blockquote>
<p>ä¸€å…±ç»™äº†ä¸¤ä¸ª img æ–‡ä»¶ï¼Œé€šè¿‡ file å¯ä»¥çœ‹å‡ºéƒ½æ˜¯ DOS/MBR boot sector
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="__codelineno-10-1"></a>$ file *.img 
<a id="__codelineno-10-2" name="__codelineno-10-2" href="__codelineno-10-2"></a>day1.img:      DOS/MBR boot sector<span class="p">;</span> partition <span class="m">1</span> : <span class="nv">ID</span><span class="o">=</span>0xee, start-CHS <span class="o">(</span>0x0,0,2<span class="o">)</span>, end-CHS <span class="o">(</span>0x3ff,255,63<span class="o">)</span>, startsector <span class="m">1</span>, <span class="m">40959</span> sectors, extended partition table <span class="o">(</span>last<span class="o">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="__codelineno-10-3"></a>day2.img:      DOS/MBR boot sector<span class="p">;</span> partition <span class="m">1</span> : <span class="nv">ID</span><span class="o">=</span>0xee, start-CHS <span class="o">(</span>0x0,0,2<span class="o">)</span>, end-CHS <span class="o">(</span>0x3ff,255,63<span class="o">)</span>, startsector <span class="m">1</span>, <span class="m">40959</span> sectors, extended partition table <span class="o">(</span>last<span class="o">)</span>
</code></pre></div>
æ‰€ä»¥å…ˆç›´æ¥ 7z æå–ï¼Œå¾—åˆ°ä¸¤ä¸ªæ–°çš„ imgï¼Œå† fileï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="__codelineno-11-1"></a>$ file *.img 
<a id="__codelineno-11-2" name="__codelineno-11-2" href="__codelineno-11-2"></a>My Disk.img:   LUKS encrypted file, ver <span class="m">2</span> <span class="o">[</span>, , sha256<span class="o">]</span> UUID: e9a660d5-4a91-4dca-bda5-3f6a49eea998
<a id="__codelineno-11-3" name="__codelineno-11-3" href="__codelineno-11-3"></a>My Disk <span class="m">2</span>.img: LUKS encrypted file, ver <span class="m">2</span> <span class="o">[</span>, , sha256<span class="o">]</span> UUID: e9a660d5-4a91-4dca-bda5-3f6a49eea998
</code></pre></div>
å‘ç°éƒ½æ˜¯ LUKS encrypted file</p>
<p>åœ¨ Kali Linux é‡Œå°è¯•ç›´æ¥æŒ‚è½½ç¬¬ä¸€ä¸ª imgï¼Œè¦æ±‚è¾“å…¥å¯†ç ï¼ŒæŠŠé¢˜ç»™çš„å¯†ç è¾“å…¥å°±å¯ä»¥çœ‹åˆ° â€œè¯¾ä»¶â€</p>
<p>ä»¥ä¸Šéƒ½æ˜¯å·²çŸ¥çš„è¯•éªŒéƒ¨åˆ†ï¼ŒçœŸæ­£è¦åšçš„æ˜¯è§£å¼€ç¬¬äºŒä¸ªæœªçŸ¥å¯†ç çš„ LUKS img <br/>
å·²çŸ¥ç£ç›˜çš„åŠ å¯†ä½¿ç”¨çš„æ˜¯ luks2ï¼Œåœ¨ç½‘ä¸ŠæŸ¥äº†ç ´è§£ luks2 ä¹‹ç±»çš„éƒ½è¯´ luks2 <strong>ä¸å¯ç ´è§£</strong>ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨å·²çŸ¥çš„å¯†ç å­—å…¸æ¥çˆ†ç ´<br/>
ä½†æ˜¯é¢˜é‡Œè¯´äº† â€œ<strong>éšæœºç”Ÿæˆ</strong>çš„å¼ºå¯†ç â€ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯æ²¡æœ‰å¯†ç å­—å…¸çš„</p>
<p>å…¶å®è¿™é“é¢˜çš„æœ€å¤§æç¤ºå°±åœ¨äºå®ƒç»™äº†ä¸¤ä¸ª imgï¼Œæ—¢ç„¶ç¬¬ä¸€ä¸ª img æ‰“å¼€åä»…ä»…æ˜¯ä¸€ä¸ªè¯¾ä»¶ï¼Œå¦‚æœå®ƒçš„ç”¨å¤„ä»…ä»…æ˜¯ç”¨æ¥è¯•éªŒ luks æ€ä¹ˆæ‰“å¼€çš„è¯ï¼Œæ ¹æœ¬å®ƒæ²¡å¿…è¦ç»™å‡º<br/>
æ‰€ä»¥ç¬¬ä¸€ä¸ª img è‚¯å®šè¿˜æ˜¯æœ‰ç”¨çš„ã€‚</p>
<p>å†çœ‹é¢˜ç›®ï¼Œåå¤è¯´äº† U ç›˜ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ª img åº”è¯¥æ˜¯åŒä¸€ä¸ª U ç›˜çš„é•œåƒæ–‡ä»¶ï¼Œåªæ˜¯æ›´æ”¹äº†å¯†ç è€Œå·²ï¼ˆfile çœ‹åˆ°çš„ uuid ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼‰<br/>
äºæ˜¯ç»§ç»­å¿…åº”ï¼Œå‘ç°åŒä¸€ä¸ªç£ç›˜çš„ <code>master-key</code> æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”å¯ä»¥ç”¨ master-key æ¥æ·»åŠ å¯†ç æ¢å¤ç£ç›˜ï¼ˆè§ï¼š<a href="https://www.thegeekstuff.com/2016/03/cryptsetup-lukskey/">10 Linux cryptsetup Examples for LUKS Key Management</a>ï¼‰</p>
<p>æ‰€ä»¥å°±è·Ÿç€æ–‡ç« é‡Œçš„åšæ³•ï¼Œä»ç¬¬ä¸€ä¸ª img ä¸­æå–å‡º master-keyï¼Œç„¶åç”¨å®ƒæ¥æä¾› AddKey çš„æƒé™ã€‚æ·»åŠ äº†æ–° passphrase åå°±å¯ä»¥ç”¨æ–°å¯†ç æ‰“å¼€ç£ç›˜äº†ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="__codelineno-12-1"></a>$ cryptsetup luksDump --dump-master-key MyDisk.img  <span class="c1"># è¾“å‡º master-key</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="__codelineno-12-2"></a>...
<a id="__codelineno-12-3" name="__codelineno-12-3" href="__codelineno-12-3"></a>MK dump:    be <span class="m">97</span> db <span class="m">91</span> 5c <span class="m">30</span> <span class="m">47</span> ce 1c <span class="m">59</span> c5 c0 8c <span class="m">75</span> 3c <span class="m">40</span> 
<a id="__codelineno-12-4" name="__codelineno-12-4" href="__codelineno-12-4"></a>            <span class="m">72</span> <span class="m">35</span> <span class="m">85</span> 9d fe <span class="m">49</span> c0 <span class="m">52</span> c4 f5 <span class="m">26</span> <span class="m">60</span> af 3e d4 2c 
<a id="__codelineno-12-5" name="__codelineno-12-5" href="__codelineno-12-5"></a>            ec a3 <span class="m">60</span> <span class="m">53</span> aa <span class="m">96</span> <span class="m">70</span> 4d f3 f2 ff <span class="m">56</span> 8f <span class="m">49</span> a1 <span class="m">82</span> 
<a id="__codelineno-12-6" name="__codelineno-12-6" href="__codelineno-12-6"></a>            <span class="m">60</span> <span class="m">18</span> 7c <span class="m">58</span> d7 6a ec e8 <span class="m">00</span> c1 <span class="m">90</span> c1 <span class="m">88</span> <span class="m">43</span> f8 9a
<a id="__codelineno-12-7" name="__codelineno-12-7" href="__codelineno-12-7"></a>$ cat <span class="s2">&quot;be...9a&quot;</span> &gt; master_key.txt <span class="c1"># å­˜å…¥æ–‡ä»¶</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="__codelineno-12-8"></a>$ xxd -r -p master_key.txt master_key.bin <span class="c1"># è½¬ä¸ºäºŒè¿›åˆ¶</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="__codelineno-12-9"></a>$ cryptsetup luksAddKey MyDisk2.img --master-key-file &lt;<span class="o">(</span>cat master_key.bin<span class="o">)</span> <span class="c1"># æ·»åŠ å¯†ç </span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="__codelineno-12-10"></a>Enter new passphrase <span class="k">for</span> key slot:    <span class="c1"># è¾“å…¥æ–°å¯†ç å³å¯ï¼Œå› ä¸ºmaster-key-fileç›¸å½“äºæä¾›äº†åŸå§‹å¯†ç </span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="__codelineno-12-11"></a>Verify passphrase: 
</code></pre></div>
ï¼ˆä¸€å®šè¦ç”¨ root æƒé™æ‰å¯ä»¥åŠ å¯†ç ï¼‰<br/>
ç„¶åæŒ‚è½½ã€è¾“å…¥å¯†ç ï¼Œå°±å¯ä»¥çœ‹åˆ° flag.txt äº†</p>
<hr />
<h2 id="_9">èµ›åšå¨æˆ¿<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<blockquote>
<p>è™½ç„¶è¿™æ˜¯ä½ çš„é¤å…ï¼Œä½†åªæœ‰æœºå™¨äººå¯ä»¥åœ¨å¨æˆ¿å·¥ä½œã€‚æœºå™¨äººç²¾ç¡®åœ°æŒ‰ç…§ç¨‹åºå·¥ä½œï¼Œåœ¨å¨æˆ¿ä¸­ç§»åŠ¨ï¼Œä»ç‰©å“æºå–å‡ºé£Ÿæï¼ŒæŒ‰ç…§èœè°±çš„é¡ºåºæŠŠé£Ÿæä¾æ¬¡æ”¾å…¥é”…å†…ã€‚</p>
<p>æœºå™¨äººä¸éœ€è¦ä¼‘æ¯ï¼Œåªéœ€è¦ä¸€ä¸ªæ™šä¸Šçš„æ—¶é—´æ¥å­¦ä¹ ä½ æ•™ç»™å®ƒçš„ç¨‹åºï¼Œåœ¨æ­¤ä¹‹åä½ å°±å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è®©æœºå™¨äººæ‰§è¡Œè¿™ä¸ªç¨‹åºï¼Œç¨‹åºçš„æ¯ä¸€æ­¥æ‰§è¡Œéƒ½ä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œæ–¹ä¾¿ä½ æ£€æŸ¥æœºå™¨äººåšèœçš„è¿‡ç¨‹ã€‚</p>
<p>å¦å¤–ä¸ºäº†ç¬¦åˆé£Ÿå“å®‰å…¨æ³•çš„è¦æ±‚ï¼Œèµ›åšå¨æˆ¿ä¸­çš„æœºå™¨äººåŒä¸€æ—¶é—´æ‰‹é‡Œåªèƒ½æ‹¿ä¸€ç§é£Ÿç‰©ï¼Œæ¯æ¬¡åšèœå‰éƒ½å¿…é¡»æ‰§è¡Œæ¸…ç†å¨æˆ¿çš„æ“ä½œï¼ŒæŠŠå„å¤„çš„é£Ÿç‰©æ®‹æ¸£æ¸…ç†æ‰ï¼Œç„¶åå›åˆ°å¨æˆ¿è§’è½å¾…å‘½ã€‚</p>
<p>æ¯å¤©çš„èœè°±å¯èƒ½ä¸åŒï¼Œä½†ä¹Ÿè®¸ä¹Ÿå­˜åœ¨ä¸€äº›è§„å¾‹ã€‚</p>
<p>å¯¹æœºå™¨äººç¼–ç¨‹å¯ä»¥ä½¿ç”¨çš„æŒ‡ä»¤æœ‰ï¼ˆn, m ä¸ºæ•´æ•°å‚æ•°ï¼Œç¨‹åºçš„è¡Œå·ä» 0 å¼€å§‹ï¼Œæ³¨æ„æŒ‡ä»¤ä¸­éœ€è¦æ­£ç¡®ä½¿ç”¨ç©ºæ ¼ï¼‰ï¼š</p>
<blockquote>
<p>å‘ä¸Š n æ­¥<br/>
å‘ä¸‹ n æ­¥<br/>
å‘å·¦ n æ­¥<br/>
å‘å³ n æ­¥<br/>
æ”¾ä¸‹ n ä¸ªç‰©å“<br/>
æ‹¿èµ· n ä¸ªç‰©å“<br/>
æ”¾ä¸‹ç›˜å­<br/>
æ‹¿èµ·ç›˜å­<br/>
å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº n å‘ä¸Šè·³è½¬ m è¡Œ<br/>
å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº n å‘ä¸‹è·³è½¬ m è¡Œ</p>
</blockquote>
<p>èµ¶ç´§è¿›å…¥èµ›åšå¨æˆ¿å¼€å§‹åšèœå§ï¼</p>
</blockquote>
<p>åˆšçœ‹é¢˜è¿˜æ˜¯æŒºæ‡µçš„ï¼Œæƒ³äº†å¥½åŠå¤©æ‰æ˜ç™½<br/>
ç®€å•è¯´æ¥å°±æ˜¯ï¼Œæ¯å¤©å¯ä»¥ç¼–å†™æ–°çš„ç¨‹åºï¼Œä½†æ˜¯åªèƒ½è¿è¡Œä¸€ä¸ªä¹‹å‰ç¼–å†™è¿‡çš„ç¨‹åº<br/>
æ¯ä¸ªç¨‹åºåªæœ‰å‡ ç§æŒ‡ä»¤å¯ä»¥ä½¿ç”¨ï¼Œéœ€è¦åœ¨å…¶ä¸­æ»¡è¶³èœè°±çš„é¡ºåºè¦æ±‚</p>
<p>è€Œé—®é¢˜åœ¨äºï¼Œç¼–å†™ç¨‹åºåçš„ç¬¬äºŒå¤©çš„èœè°±å¯èƒ½ä¼šä¸åŒï¼Œå¯¼è‡´å‰é¢ç¼–å†™çš„ç¨‹åºæ— æ³•ä½¿ç”¨<br/>
æ‰€ä»¥å°±éœ€è¦<em>é¢„æµ‹</em>ç¬¬äºŒå¤©çš„èœè°±</p>
<h3 id="level-0">Level 0<a class="headerlink" href="#level-0" title="Permanent link">&para;</a></h3>
<p>å¯ä»¥çœ‹åˆ°ç¬¬ 0 å¤©çš„èœè°±æ˜¯ 1, 0ï¼Œä¹Ÿå°±æ˜¯è¦åœ¨åŒä¸€ä¸ªç¨‹åºä¸­ä¾æ¬¡å‘é”…(1,0)ä¸­æ”¾å…¥ 1 å·é£Ÿç‰©(0,2)å’Œ 0 å·é£Ÿç‰©(0,1)<br/>
éšä¾¿ç¼–å†™ç¨‹åºä¿å­˜ï¼Œç›´æ¥åˆ°ä¸‹ä¸€å¤©ï¼Œå¯ä»¥å‘ç°èœè°±å‘ç”Ÿäº†å˜åŒ–<br/>
å¤šæ¬¡å°è¯•ä¹‹åå‘ç°èœè°±<strong>åªæœ‰ 0,0 / 0,1 / 1,0 / 1,1 å››ç§</strong></p>
<p>æ‰€ä»¥åœ¨ç¬¬ 0 å¤©ç¼–å†™å­¦ä¹ å››ä¸ªç¨‹åºï¼Œåˆ°ä¸‹ä¸€å¤©å°±å¯ä»¥æ ¹æ®èœè°±æ¥æ‰§è¡Œäº†<br/>
ä¾‹å¦‚ç¨‹åº 1,0 å°±å¯ä»¥ç¼–å†™ä¸ºï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="__codelineno-13-1"></a>å‘å³ 2 æ­¥
<a id="__codelineno-13-2" name="__codelineno-13-2" href="__codelineno-13-2"></a>æ‹¿èµ· 1 ä¸ªç‰©å“
<a id="__codelineno-13-3" name="__codelineno-13-3" href="__codelineno-13-3"></a>å‘å·¦ 2 æ­¥
<a id="__codelineno-13-4" name="__codelineno-13-4" href="__codelineno-13-4"></a>å‘ä¸‹ 1 æ­¥
<a id="__codelineno-13-5" name="__codelineno-13-5" href="__codelineno-13-5"></a>æ”¾ä¸‹ 1 ä¸ªç‰©å“
<a id="__codelineno-13-6" name="__codelineno-13-6" href="__codelineno-13-6"></a>å‘ä¸Š 1 æ­¥
<a id="__codelineno-13-7" name="__codelineno-13-7" href="__codelineno-13-7"></a>å‘å³ 1 æ­¥
<a id="__codelineno-13-8" name="__codelineno-13-8" href="__codelineno-13-8"></a>æ‹¿èµ· 1 ä¸ªç‰©å“
<a id="__codelineno-13-9" name="__codelineno-13-9" href="__codelineno-13-9"></a>å‘å·¦ 1 æ­¥
<a id="__codelineno-13-10" name="__codelineno-13-10" href="__codelineno-13-10"></a>å‘ä¸‹ 1 æ­¥
<a id="__codelineno-13-11" name="__codelineno-13-11" href="__codelineno-13-11"></a>æ”¾ä¸‹ 1 ä¸ªç‰©å“
<a id="__codelineno-13-12" name="__codelineno-13-12" href="__codelineno-13-12"></a>å‘ä¸Š 1 æ­¥
</code></pre></div>
åªè¦æ­£ç¡®äº†ä¸€å¤©ï¼Œå°±å¯ä»¥æ‹¿åˆ° flag äº†</p>
<h3 id="level-1">Level 1<a class="headerlink" href="#level-1" title="Permanent link">&para;</a></h3>
<p>åªæœ‰ 1 ä¸ªé£Ÿç‰©ï¼Œèœè°±æ˜¯å¥½å¤š 0<br/>
åŒæ ·éšä¾¿ç¼–å†™ç¨‹åºä¿å­˜è¿›å…¥ä¸‹ä¸€å¤©ï¼Œå‘ç°èœè°±<strong>æ²¡æœ‰å˜åŒ–</strong>ï¼Œè¿˜æ˜¯ 73 ä¸ª 0<br/>
æ‰€ä»¥è¿™ä¸€å…³å¯èƒ½åªæ˜¯å¾ªç¯çš„æ•™ç¨‹<br/>
å¯ç”¨çš„æŒ‡ä»¤ä¸­æœ‰ä¸€æ¡ â€œå¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº n å‘ä¸Šè·³è½¬ m è¡Œâ€<br/>
å¯ä»¥ç”¨å®ƒæ¥è¾¾åˆ°<strong>å¾ªç¯</strong>çš„æ•ˆæœ</p>
<p>åªéœ€è¦æ‹¿ 73 ä¸ªç‰©å“ï¼Œç„¶åå¾ªç¯æ”¾ä¸‹ç›´åˆ°æ‰‹ä¸­æ²¡æœ‰äº†å³å¯
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="__codelineno-14-1"></a>å‘å³ 1 æ­¥
<a id="__codelineno-14-2" name="__codelineno-14-2" href="__codelineno-14-2"></a>æ‹¿èµ· 73 ä¸ªç‰©å“
<a id="__codelineno-14-3" name="__codelineno-14-3" href="__codelineno-14-3"></a>å‘å·¦ 1 æ­¥
<a id="__codelineno-14-4" name="__codelineno-14-4" href="__codelineno-14-4"></a>å‘ä¸‹ 1 æ­¥
<a id="__codelineno-14-5" name="__codelineno-14-5" href="__codelineno-14-5"></a>æ”¾ä¸‹ 1 ä¸ªç‰©å“
<a id="__codelineno-14-6" name="__codelineno-14-6" href="__codelineno-14-6"></a>å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº 1 å‘ä¸Šè·³è½¬ 1 è¡Œ
</code></pre></div>
åŒæ ·ä¿å­˜ä¸‹ä¸€å¤©æ‰§è¡Œå°±å¯ä»¥æ‹¿åˆ° flag äº† </p>
<p><del>å‰©ä¸‹çš„ä¸¤ä¸ªçœ‹èµ·æ¥å¤§æ¦‚æ˜¯é€šè¿‡æºç æ¥æ¨æµ‹å‡ºèœè°±çš„ç”Ÿæˆæ–¹æ³•ï¼Œç„¶åç¼–å†™ç›¸åº”çš„æŒ‡ä»¤ï¼Œå¤ªéš¾äº†ï¼Œä¸ä¼šqwq</del></p>
<hr />
<h2 id="micro-world">Micro World<a class="headerlink" href="#micro-world" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-REVERSE-inactive?style=flat-square" /></p>
<blockquote>
<p>å®‡å®™ä¸­æŸä¸€ç‰‡æå…¶å¾®å°çš„åŒºåŸŸé‡Œçš„ç²’å­è¢«ä¸€è‚¡ç¥ç§˜åŠ›é‡åˆå§‹åŒ–è®¾ç½®æˆäº† flag çš„å½¢çŠ¶ï¼Œç¨‹åºå¿ å®åœ°è®°å½•äº†ä¸€æ®µæ—¶é—´ä¹‹åè¿™ç‰‡åŒºåŸŸçš„ç²’å­è¿åŠ¨æƒ…å†µã€‚</p>
</blockquote>
<p>æ‹¿åˆ°äº† exe æ–‡ä»¶ï¼Œçœ‹èµ·æ¥æŒºç²¾è‡´ï¼Œè¿è¡Œèµ·æ¥æ˜¯ä¸€äº›ç‚¹è¿åŠ¨ç¢°æ’çš„åœºæ™¯<br/>
æ‹–åˆ° IDA é‡Œçœ‹çœ‹ï¼Œå‘ç°äº† __main__ ä»¥åŠ .rdata é‡Œä¸€äº› py æœ‰å…³çš„å­—ç¬¦ä¸²ï¼š
<img alt="" src="/assets/images/writeups/hackergame2021/microworld.png" />
æ‰€ä»¥æ¨æµ‹æ˜¯ä½¿ç”¨ python ç¼–å†™çš„ï¼Œç„¶åç”¨ pyinstaller æ‰“åŒ…</p>
<p>è¿™æ ·çš„è¯è¯•ç€ç”¨ <a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a> è§£åŒ… .exeï¼ŒæˆåŠŸå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹<br/>
é‡Œé¢æ˜¯ä¸€å † .pyc .pyd .dll æ–‡ä»¶ï¼Œä»åå­—å°±å¯ä»¥çœ‹å‡ºå¤§éƒ¨åˆ†æ˜¯ import çš„åŒ…ï¼Œåªæœ‰ä¸€ä¸ªç‰¹åˆ«çš„ 2.pyc <br/>
æ‰€ä»¥è¿™ä¸ªåº”è¯¥å°±æ˜¯ç¼–è¯‘åçš„æºç äº†</p>
<p>æ¥ä¸‹æ¥ç”¨ <a href="https://github.com/rocky/python-uncompyle6/">uncompyle6</a> æ¥åç¼–è¯‘ pyc æ–‡ä»¶ï¼Œè¾“å‡ºå¾—åˆ°äº†æºç  2.py<br/>
å°è¯•è¿è¡Œï¼Œå‘ç°è·‘èµ·æ¥ä¹‹ååªæœ‰ä¸€ä¸ªç‚¹åœ¨è¿åŠ¨ï¼Œåº”è¯¥æ˜¯åç¼–è¯‘æ—¶å‡ºäº†äº›é—®é¢˜<br/>
äºæ˜¯å¼€å§‹çœ‹æºç  </p>
<p>åŸºæœ¬ä¸Šç®€å•è¯´å°±æ˜¯ï¼Œåˆå§‹æœ‰ä¸€äº›æ•°æ®ï¼Œè¡¨ç¤ºæ¯ä¸ªç‚¹çš„ä½ç½®å’Œé€Ÿåº¦ï¼Œç„¶åè¿è¡Œï¼Œæ¯æ¬¡è¿è¡Œéƒ½æ£€æµ‹ç¢°æ’ï¼Œç„¶åè·å¾—æ–°çš„ç‚¹ä½ç½®ï¼Œå†ç»˜åˆ¶å‡ºæ¥<br/>
è°ƒè¯•ä¸€ä¸‹ï¼Œè¾“å‡ºæ¯æ¬¡çš„ pointlistï¼Œå‘ç°ç¬¬ä¸€æ¬¡æ˜¯æ‰€æœ‰ç‚¹ï¼Œç¬¬äºŒæ¬¡å˜æˆ2ä¸ªï¼Œç¬¬ä¸‰æ¬¡å¾€åå°±åªæœ‰ä¸€ä¸ªäº†<br/>
æ‰€ä»¥é—®é¢˜å¤§æ¦‚å°±å‡ºåœ¨äº† next_pos_list å‡½æ•°ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="__codelineno-15-1"></a><span class="k">def</span> <span class="nf">next_pos_list</span><span class="p">(</span><span class="n">Pointlist</span><span class="p">):</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="__codelineno-15-2"></a>    <span class="n">pointlist</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="__codelineno-15-3"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Pointlist</span><span class="p">)):</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="__codelineno-15-4"></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">Pointlist</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="__codelineno-15-5"></a>            <span class="n">times</span> <span class="o">=</span> <span class="n">checkcrush</span><span class="p">(</span><span class="n">Pointlist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="__codelineno-15-6"></a>            <span class="k">if</span> <span class="n">times</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="__codelineno-15-7"></a>                <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">get_new_point</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">Pointlist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="__codelineno-15-8"></a>                <span class="n">pointlist</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="__codelineno-15-9"></a>                <span class="n">Pointlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="__codelineno-15-10"></a>                <span class="n">point</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="__codelineno-15-11"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="__codelineno-15-12"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">Pointlist</span><span class="p">:</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="__codelineno-15-13"></a>                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">flag</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="__codelineno-15-14"></a>                    <span class="n">pointlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point</span><span class="p">((</span><span class="n">item</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">vy</span><span class="p">),</span> <span class="n">item</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">vy</span><span class="p">))</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="__codelineno-15-15"></a>                <span class="k">for</span> <span class="n">poi</span> <span class="ow">in</span> <span class="n">pointlist</span><span class="p">:</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="__codelineno-15-16"></a>                    <span class="n">poi</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">poi</span><span class="o">.</span><span class="n">x</span> <span class="o">%</span> <span class="n">WIDTH</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="__codelineno-15-17"></a>                    <span class="n">poi</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">poi</span><span class="o">.</span><span class="n">y</span> <span class="o">%</span> <span class="n">HEIGHT</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="__codelineno-15-18"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="__codelineno-15-19"></a>                    <span class="k">return</span> <span class="n">pointlist</span>
</code></pre></div>
ä»”ç»†è¯»ä¸€è¯»ï¼Œå¯ä»¥å‘ç°è¿™é‡Œé¢çš„ for-else å—å¾ˆå¥‡æ€ªï¼Œå¯¼è‡´å¾ªç¯ç»“æŸå’Œ return éƒ½æ—©äº†ï¼Œæ‰€ä»¥æ ¹æ®å‡½æ•°çš„æ„æ€æ”¹ä¸€æ”¹ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="__codelineno-16-1"></a><span class="k">def</span> <span class="nf">next_pos_list</span><span class="p">(</span><span class="n">Pointlist</span><span class="p">):</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="__codelineno-16-2"></a>    <span class="n">pointlist</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="__codelineno-16-3"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Pointlist</span><span class="p">)):</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="__codelineno-16-4"></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">Pointlist</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="__codelineno-16-5"></a>            <span class="o">...</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="__codelineno-16-6"></a>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">Pointlist</span><span class="p">:</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="__codelineno-16-7"></a>        <span class="o">...</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="__codelineno-16-8"></a>    <span class="k">return</span> <span class="n">pointlist</span>
</code></pre></div>
è¿™æ ·å°±å¯ä»¥æˆåŠŸè¿è¡Œäº†</p>
<p>ä½†æ˜¯ç”»é¢ä»ç„¶æ˜¯æ‚ä¹±çš„ã€‚å› ä¸ºé¢˜é‡Œè¯´äº† â€œè®°å½•äº†<strong>ä¸€æ®µæ—¶é—´ä¹‹å</strong>è¿™ç‰‡åŒºåŸŸçš„ç²’å­è¿åŠ¨æƒ…å†µâ€<br/>
æ‰€ä»¥éœ€è¦å°†è½¨è¿¹å¾€å‰æ¨ï¼Œæœ€æ–¹ä¾¿çš„æ–¹æ³•å°±æ˜¯æ›´æ”¹æ¯ä¸ªç‚¹çš„é€Ÿåº¦æ–¹å‘ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="__codelineno-17-1"></a><span class="n">Pointlist</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="__codelineno-17-2"></a><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="__codelineno-17-3"></a>    <span class="n">Pointlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point</span><span class="p">((</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="o">-</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</code></pre></div>
è¿è¡Œåç­‰å¾…ä¸€å°ä¼šå„¿å°±å¯ä»¥çœ‹åˆ°ç‚¹é€æ¸æœ‰åºï¼Œåœ¨æŸä¸€åˆ»æ±‡æˆäº† flagï¼š
<img alt="" src="/assets/images/writeups/hackergame2021/mwans.jpg" />
è™½ç„¶ä¸å¤ªæ¸…æ™°ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥çŒœä¸ªå¤§æ¦‚</p>
<hr />
<h2 id="_10">é˜µåˆ—æ¢å¤å¤§å¸ˆ<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<p>ï¼ˆè¿™é¢˜æ•´æ•´åšäº†æˆ‘ä¸¤å¤©å¤šï¼Œæ¯å¤©æ™šä¸Šéƒ½å¯¹ç€ç£ç›˜é˜µåˆ—â€¦â€¦ï¼‰</p>
<blockquote>
<p>ä»¥ä¸‹æ˜¯ä¸¤ä¸ªå‹ç¼©åŒ…ï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ª RAID 0 é˜µåˆ—çš„ç£ç›˜å‹ç¼©åŒ…ï¼Œå’Œä¸€ä¸ª RAID 5 é˜µåˆ—çš„ç£ç›˜å‹ç¼©åŒ…ï¼Œå¯¹åº”æœ¬é¢˜çš„ä¸¤å°é—®ã€‚ä½ éœ€è¦è§£æå¾—åˆ°æ­£ç¡®å®Œæ•´çš„ç£ç›˜é˜µåˆ—ï¼ŒæŒ‚è½½ç¬¬ä¸€ä¸ªåˆ†åŒºååœ¨è¯¥åˆ†åŒºæ ¹ç›®å½•ä¸‹ä½¿ç”¨ Python 3.7 æˆ–ä»¥ä¸Šç‰ˆæœ¬æ‰§è¡Œ getflag.py è„šæœ¬ä»¥è·å– flagã€‚ç£ç›˜æ•°æ®ä¿è¯æ— æŸåã€‚</p>
</blockquote>
<h3 id="raid-5">RAID 5<a class="headerlink" href="#raid-5" title="Permanent link">&para;</a></h3>
<p>è™½ç„¶ RAID 5 æ˜¯ç¬¬äºŒé—®ï¼Œè€Œä¸”åˆ†æ•°é«˜ï¼Œä½†æ˜¯æ›´å¥½åšï¼Œè€Œä¸”åšå‡ºçš„äººä¹Ÿå¤šã€‚<br/>
å› ä¸ºæ•°æ®ä¿è¯æ— æŸåï¼Œæ‰€ä»¥è¦åšçš„ä»…ä»…æ˜¯æ‰¾å‡ºäº”ä¸ªç£ç›˜çš„é¡ºåºå’Œå—å¤§å°</p>
<p>é¡ºåºå¯ä»¥å…ˆç®€å•åœ°çœ‹çœ‹ strings *.img è¾“å‡ºçš„å†…å®¹<br/>
é€ä¸ªæ–‡ä»¶çœ‹ï¼Œå¯ä»¥å‘ç°æ¯ä¸ªæ–‡ä»¶æ¯”è¾ƒé å‰çš„åœ°æ–¹ä¼šæœ‰ä¸€æ®µæ˜¯ git å†å²è®°å½•çš„ä¸€éƒ¨åˆ†:
<img alt="" src="/assets/images/writeups/hackergame2021/raid5.png" />
æ ¹æ®é‡Œé¢çš„æ—¶é—´å¯ä»¥æ¨æ–­å‡ºç£ç›˜çš„é¡ºåºå¤§è‡´æ˜¯ï¼š</p>
<p style="text-align: center;">Qj... -> 60... -> 3R... -> Ir... -> 3D...</p>
<p>åªæ˜¯ï¼Œè¿™ä¸ªé¡ºåºåº”è¯¥æ˜¯ä¸€ä¸ªç¯ï¼Œè°åœ¨ç¬¬ä¸€è¿˜æ²¡åŒºåˆ†å‡ºæ¥</p>
<p>åœ¨çœ‹æ¯ä¸ªæ–‡ä»¶çš„å¤´éƒ¨ï¼Œåªæœ‰ 60... å’Œ 3R... æœ‰ â€œEFI PARTâ€:
<img alt="" src="/assets/images/writeups/hackergame2021/raid5_.png" />
æ‰€ä»¥åº”è¯¥æ˜¯ä¸€ä¸ªåœ¨å¼€å¤´ï¼Œä¸€ä¸ªåœ¨ç»“å°¾ã€‚æ‰€ä»¥æœ€ç»ˆçš„é¡ºåºæ˜¯ï¼š</p>
<p style="text-align: center;">3R... -> Ir... -> 3D... -> Qj... -> 60...</p>

<p>ç„¶åéœ€è¦æ‰¾åˆ°å—å¤§å°<br/>
ç›´æ¥ä¸¢åˆ° DiskGenius é‡Œç»„å»ºè™šæ‹Ÿ RAIDï¼Œé€‰å·¦åŒæ­¥ï¼Œç„¶åå¯ä»¥è¯•å‡ºæ¥å½“å—å¤§å°æ˜¯ 64k çš„æ—¶å€™æ­£å¥½å¯ä»¥æ‹¼å‡ºå®Œæ•´ç£ç›˜<br/>
ç„¶åå…‹éš†ç£ç›˜ç”Ÿæˆ img æ–‡ä»¶ï¼Œå†æŒ‚è½½ï¼Œè¿›å…¥ï¼Œæ‰§è¡Œ getflag.py å°±å¾—åˆ°äº† flag </p>
<h3 id="raid-0">RAID 0<a class="headerlink" href="#raid-0" title="Permanent link">&para;</a></h3>
<p>åœ¨åš RAID 5 çš„æ—¶å€™è¿˜å‘ç°äº†ä¸€ä¸ªå« Raid Reconstructor çš„è½¯ä»¶ï¼Œå¯ä»¥çˆ†ç ´ RAID é˜µåˆ—é¡ºåºå’Œå—å¤§å°<br/>
æ‰€ä»¥è¿™é—®ä¹Ÿå°±æ‡’å¾—çœ‹äº†ï¼Œç›´æ¥ä¸¢ç»™ Raid Reconstructor æ¥çˆ†ç ´ï¼Œå¾—åˆ°æœ€æ¨èçš„é¡ºåºï¼š</p>
<p style="text-align: center;">wl. -> jC. -> 1G. -> 5q. -> d3. -> eR. -> RA. -> ID.</p>
<p>å’Œå—å¤§å° 128k</p>
<p>ç„¶åç›´æ¥ç”¨ Raid Reconstructor çš„ Copy å¯¼å‡º img æ–‡ä»¶ï¼Œæå–ååˆå¾—åˆ°ä¸€ä¸ªæ–°çš„ img æ–‡ä»¶<br/>
é€šè¿‡ file å¯ä»¥çœ‹åˆ°ç»“æœçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ XFS
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="__codelineno-18-1"></a>$ file MyDisk.img
<a id="__codelineno-18-2" name="__codelineno-18-2" href="__codelineno-18-2"></a>MyDisk.img: SGI XFS filesystem data <span class="o">(</span>blksz <span class="m">4096</span>, inosz <span class="m">512</span>, v2 <span class="nb">dirs</span><span class="o">)</span>
</code></pre></div></p>
<p>ä½†æ˜¯å§‹ç»ˆæ— æ³•æŒ‚è½½ï¼ˆæäº†ä¸€å¤©ï¼‰<br/>
å¯èƒ½æ˜¯ Raid Reconstructor çš„é—®é¢˜ï¼Œæ‰€ä»¥åˆç”¨ DiskGenius è¯•äº†ä¸‹<br/>
å› ä¸º win å’Œ DiskGenius è¯»ä¸äº† XFS æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥æ‹¼èµ·æ¥ä¹‹åç›´æ¥å…‹éš†å‡º img æ–‡ä»¶<br/>
ç„¶åæ‹–åˆ° Kali Linux é‡ŒæŒ‚è½½ï¼ŒæˆåŠŸæŒ‚è½½åè¿›å…¥ã€è¿è¡Œ getflag.py å°±å¾—åˆ°äº† flag </p>
<hr />
<h2 id="_11">åŠ©è®°è¯<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" />
<img alt="" src="https://img.shields.io/badge/-CRYPTO-orange?style=flat-square" /></p>
<p>é¢˜ç›®æœ‰æ•ˆå†…å®¹ï¼š</p>
<blockquote>
<p>ä½ çš„å®¤å‹ç»ˆäºè¿å¤œèµ¶å®Œäº†ä»–çš„ Java è¯­è¨€ç¨‹åºè®¾è®¡çš„è¯¾ç¨‹å¤§ä½œä¸šã€‚çœ‹èµ·æ¥ä»–ä½¿ç”¨ Java 17 å†™äº†ä¸€ä¸ªä¿å­˜åŠ©è®°è¯çš„åç«¯ï¼Œå½“ç„¶è¿˜æœ‰é…å¥—çš„å‰ç«¯ã€‚åŠ©è®°è¯ç”±å››ä¸ªè‹±æ–‡å•è¯ç»„æˆï¼Œæ¯ä¸ªç”¨æˆ·æœ€å¤šä¿å­˜ 32 æ¡ã€‚</p>
<p>ä½ ä»ä»–å……æ»¡æ¿€æƒ…å´åˆå¤¹æ‚ä¸æ¸…çš„è¡¨è¿°ä¸­å¾—çŸ¥ï¼Œä»–ä¼¼ä¹è¿˜ä¸ºæ­¤ä¸“é—¨åœ¨å¤§ä½œä¸šé‡Œè—äº†ä¸¤ä¸ª flagï¼šå½“è®¿é—®å»¶è¿Ÿè¾¾åˆ°ä¸¤ä¸ªç‰¹æ®Šçš„é˜ˆå€¼æ—¶ï¼Œflag ä¾¿ä¼šæ‰“å°å‡ºæ¥ï¼Œå±Šæ—¶ä½ ä¾¿å¯ä»¥æ‹¿ç€ flag è®©ä½ çš„å®¤å‹è¯·ä½ åƒä¸€é¡¿å¤§é¤ã€‚</p>
</blockquote>
<p>ä¸‹è½½åˆ°æºç åç¿»ä¸€ç¿»ï¼Œæœ‰ç”¨çš„å°±åªæœ‰ Phrase.java å’Œ Instance.java <br/>
å…¶ä¸­ Phrase.java å®šä¹‰äº† Phraseï¼Œå…¶ä¸­é‡è½½äº† <code>equals</code> æ–¹æ³•ï¼Œå…¶ä¸­æœ‰ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="__codelineno-19-1"></a><span class="k">try</span> <span class="p">{</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="__codelineno-19-2"></a>    <span class="n">TimeUnit</span><span class="p">.</span><span class="na">MILLISECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">EQUALS_DURATION_MILLIS</span><span class="p">);</span> <span class="c1">// 20ms</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="__codelineno-19-3"></a>    <span class="c1">// TODO: remove it since it is for debugging</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="__codelineno-19-4"></a><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="__codelineno-19-5"></a>    <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="__codelineno-19-6"></a><span class="p">}</span>
</code></pre></div>
æ‰€ä»¥åœ¨æ¯æ¬¡æ¯”è¾ƒç›¸ç­‰çš„æ—¶å€™å°±ä¼š sleep 20ms </p>
<p>è€Œ Instance.java çš„ post æ–¹æ³•ä¸­å¯¹äºæ¯æ¬¡çš„è¾“å…¥ï¼Œéå†è¾“å…¥çš„åˆ—è¡¨ï¼Œç„¶åé€ä¸ªåŠ è¿› HashMap ä¸­ <br/>
åœ¨åŠ å…¥ HashMap çš„æ—¶å€™å°±æ¶‰åŠåˆ°åˆ¤æ–­æ˜¯å¦ç›¸ç­‰<br/>
è€Œæœ€ç»ˆä¼šåˆ¤æ–­åœ¨å®Œæˆå‰åçš„æ€»çš„æ—¶é—´é—´éš”æ˜¯å¤šå°‘ï¼Œå¦‚æœå¤§äº 600ms å°±æå–å‡ºç¬¬ä¸€ä¸ª flagï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="__codelineno-20-1"></a><span class="kd">var</span> <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="__codelineno-20-2"></a><span class="kd">var</span> <span class="n">before</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">nanoTime</span><span class="p">();</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="__codelineno-20-3"></a><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">input</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_PHRASES</span> <span class="o">&amp;&amp;</span> <span class="n">phrases</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">MAX_PHRASES</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="__codelineno-20-4"></a>    <span class="kd">var</span> <span class="n">text</span> <span class="o">=</span> <span class="n">input</span><span class="p">.</span><span class="na">optString</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">(</span><span class="n">Locale</span><span class="p">.</span><span class="na">ENGLISH</span><span class="p">);</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="__codelineno-20-5"></a>    <span class="n">modified</span> <span class="o">+=</span> <span class="n">phrases</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">Phrase</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mnemonics</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span> <span class="o">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="__codelineno-20-6"></a>    <span class="c1">// è¿™é‡Œä¼š sleep</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="__codelineno-20-7"></a><span class="p">}</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="__codelineno-20-8"></a><span class="kd">var</span> <span class="n">after</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">nanoTime</span><span class="p">();</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="__codelineno-20-9"></a><span class="kd">var</span> <span class="n">duration</span> <span class="o">=</span> <span class="n">TimeUnit</span><span class="p">.</span><span class="na">MILLISECONDS</span><span class="p">.</span><span class="na">convert</span><span class="p">(</span><span class="n">after</span> <span class="o">-</span> <span class="n">before</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">.</span><span class="na">NANOSECONDS</span><span class="p">);</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="__codelineno-20-10"></a><span class="k">if</span> <span class="p">(</span><span class="n">duration</span> <span class="o">&gt;</span> <span class="n">FLAG1_DURATION_MILLIS</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 600ms</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="__codelineno-20-11"></a>    <span class="n">token</span><span class="p">.</span><span class="na">addFlag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">flag</span> <span class="o">-&gt;</span> <span class="n">output</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;flag1&quot;</span><span class="p">,</span> <span class="n">flag</span><span class="p">));</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="__codelineno-20-12"></a><span class="p">}</span>
</code></pre></div></p>
<p>è€Œåœ¨ç½‘é¡µä¸­æ·»åŠ æ¡ç›®çš„æ—¶å€™ï¼Œä¸€æ¬¡åªèƒ½æ·»åŠ ä¸€æ¡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª POST é‡Œé¢åªæœ‰ä¸€ä¸ª Phrase <br/>
ä½†æ˜¯æºç ä¸­æœ‰ä¸€ä¸ªå¾ªç¯ï¼Œéå†æ•´ä¸ª inputï¼Œæ‰€ä»¥ä¸€ä¸ª POST é‡Œçš„å†…å®¹å…¶å®æ˜¯ä¸€ä¸ªåˆ—è¡¨<br/>
æ‰€ä»¥å¯ä»¥ç”¨ BurpSuite è·å– POST ç„¶åæ›´æ”¹ä¸€ä¸‹å†…å®¹å†å‘é€å‡ºå»ï¼ˆå…ˆ random ä¸€ä¸ªï¼Œç„¶å addï¼‰
<img alt="" src="/assets/images/writeups/hackergame2021/mnemonic.png" />
æ ¹æ® flag é‡Œçš„æç¤ºï¼Œæ­£è§£ï¼ˆç¬¬äºŒé¡¿å¤§é¤ï¼‰åº”è¯¥æ˜¯ä½¿ç”¨å“ˆå¸Œç¢°æ’ï¼Œ<del>ä½†æ˜¯ä¸ä¼š</del></p>
<hr />
<h2 id="_12">é©¬èµ›å…‹<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<p>ï¼ˆè¿™é“é¢˜å·²ç»åšç ´é˜²äº†ï¼Œæœ¬ä»¥ä¸ºæ˜¯ä¸ªé’é“œï¼Œç»“æœæ˜¯ä¸ªç‹è€…â€¦â€¦ï¼‰<br/>
æˆ‘åšçš„è‚¯å®šä¸æ˜¯æ­£è§£ï¼Œåˆ©ç”¨äºŒç»´ç çº é”™èƒ½åŠ›å‹‰å¼ºæ‹¿åˆ°äº† flagï¼Œæ‰€ä»¥å°±ä¸è¯¦ç»†å†™ writeup äº†ï¼Œä¸»è¦è¿˜æ˜¯è¦çœ‹å®˜æ–¹ wpï¼ˆé€ƒ</p>
<p>å¤§æ¦‚æ­¥éª¤å°±æ˜¯ï¼š</p>
<ol>
<li>è¯»å›¾ç‰‡</li>
<li>æŠŠå·²çŸ¥çš„åƒç´ æå–å‡ºæ¥</li>
<li>æŠŠå››ä¸ªå°å®šä½å—å¡«ä¸Š</li>
<li>æŒ¨ä¸ªé©¬èµ›å…‹å—å¯»æ‰¾ä½¿è¿˜åŸçš„æ•°æ®å¹³å‡æ•°ä¸åŸé©¬èµ›å…‹å€¼å·®çš„ç»å¯¹å€¼å°äº1çš„å¡«è¡¥æ–¹æ³•<ul>
<li>å¦‚æœåªæœ‰ä¸€ç§å°±å¡«ä¸Šï¼Œå¹¶ä¸”æ ‡æ³¨å·²ç»å¡«å¥½ï¼Œä»¥åä¸å†æœå¯»</li>
<li>å¦‚æœæœ‰å¤šç§å°±å…ˆæ”¾ä¸‹ä¸å¡«</li>
</ul>
</li>
<li>é‡å¤4çš„è¿‡ç¨‹ï¼Œè¿™æ˜¯è¿˜ä¼šæœ‰å”¯ä¸€ç¡®å®šçš„å¡«è¡¥æ–¹æ¡ˆã€‚é‡å¤4æ¬¡å¤§æ¦‚å°±ä¸å‰©å”¯ä¸€è§£äº†</li>
<li>è¿™æ—¶é‡å¤4ï¼Œæ‰¾å‡ºä»…æœ‰2ä¸­å¡«è¡¥æ–¹æ³•çš„ï¼Œé€‰è¯¯å·®æœ€å°çš„å¡«ä¸Š</li>
<li>ç„¶åå†é‡å¤4</li>
<li>ç„¶åé‡å¤6</li>
<li>ç„¶åé‡å¤4 </li>
<li>è¿™æ—¶å¯ä»¥çœ‹åˆ°å·²ç»è¿˜åŸå¾—å·®ä¸å¤šäº†ï¼Œå‰©ä¸‹çš„ä¸ç®¡ç›´æ¥æ‰«ç ä¹Ÿå¯ä»¥æ‰«å‡º flag äº† </li>
</ol>
<div style="text-align: center;"><img src="/assets/images/writeups/hackergame2021/msc.jpg" width="35%" height="35%"></div>

<p><del>çœ‹ï¼Œåšæ³•å¾ˆçƒ‚å¯¹å§</del></p>
<hr />
<h2 id="minecraft">minecRaft<a class="headerlink" href="#minecraft" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-WEB-blueviolet?style=flat-square" />
<img alt="" src="https://img.shields.io/badge/-REVERSE-inactive?style=flat-square" /></p>
<blockquote>
<p>kk åŒå­¦å¾ˆå–œæ¬¢ç© Minecraftï¼Œä»–æœ€è¿‘æ”¶åˆ°äº†ä¸€å¼  MC åœ°å›¾ï¼Œåœ°å›¾é‡Œé¢æœ‰ä¸‰ç›ç¯ï¼Œè¿˜æœ‰å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„å‹åŠ›æ¿ã€‚</p>
<p>ä½†ä»–å‘ç°è¿™äº›ç¯å¥½åƒä¸å¤ªç¬¦åˆ MC ç”µç£å­¦ï¼ˆRed stoneï¼‰ï¼Œä½ èƒ½å¸®ä»–æŠŠç¯å…¨éƒ¨ç‚¹äº®å—ï¼Ÿ</p>
<p>æ³¨ï¼šæœ¬é¢˜è§£æ³•ä¸åŸç‰ˆ Minecraft æ¸¸æˆæ— å…³ã€‚</p>
<p>è¡¥å……è¯´æ˜ï¼šflag èŠ±æ‹¬å·å†…ä¸ºè®©ä¸‰ç›ç¯å…¨éƒ¨ç‚¹äº®çš„æœ€çŸ­çš„è¾“å…¥åºåˆ—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¸©è¸å‹åŠ›æ¿è¾“å…¥çš„æœ€çŸ­çš„åºåˆ—ä¸º abcï¼Œåˆ™ç­”æ¡ˆä¸º flag{abc}ã€‚</p>
</blockquote>
<p>è¿˜æŒºå¥½ç©çš„é¢˜ï¼Œåœ¨ç½‘é¡µä¸­æ¨¡æ‹Ÿäº†ä¸€ä¸ªmcå‡ºæ¥<br/>
çœ‹æºç çœ‹åˆ°äº†å¼•å…¥äº† flag.js æ–‡ä»¶ï¼Œæ‰€ä»¥å¯èƒ½å°±æ˜¯è¦é€šè¿‡å®ƒæ¥å¾—åˆ°ç­”æ¡ˆï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="__codelineno-21-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;jsm/miscs/flag.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>
ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆåˆ¤æ–­æ˜¯å¦æ­£ç¡®æ˜¯é€šè¿‡è°ƒç”¨ <code>gyflagh(input)</code> æ˜¯å¦ä¸º true æ¥åˆ¤æ–­ï¼Œè€Œ gyflagh ä¹Ÿåœ¨ flag.js ä¸­ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦çœ‹ flag.js </p>
<p>ä½†æ˜¯ flag.js æ˜¯ç»è¿‡ç®€å•æ··æ·†è¿‡çš„ï¼Œè¿˜æ˜¯è¦è´¹ç‚¹æ—¶é—´è¯»ä¸€ä¸‹</p>
<p>å…¶ä¸­æœ‰å››ä¸ªè½¬æ¢ Str4 Base16 å’Œ Long çš„å‡½æ•°å¯ä»¥ç•¥æ‰ä¸ç®¡<br/>
æ³¨æ„åˆ°äº† <code>_0x381b()</code> è¿™ä¸ªå‡½æ•°é‡Œæœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œä¸”æ¯”è¾ƒç®€å•ï¼Œå…¶å®å®ƒè¿”å›çš„å°±æ˜¯è¿™ä¸ªåˆ—è¡¨
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="__codelineno-22-1"></a>[&#39;encrypt&#39;, &#39;33MGcQht&#39;, &#39;6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c&#39;, &#39;14021KbbewD&#39;, &#39;charCodeAt&#39;, &#39;808heYYJt&#39;, &#39;5DlyrGX&#39;, &#39;552oZzIQH&#39;, &#39;fromCharCode&#39;, &#39;356IjESGA&#39;, &#39;784713mdLTBv&#39;, &#39;2529060PvKScd&#39;, &#39;805548mjjthm&#39;, &#39;844848vFCypf&#39;, &#39;4bIkkcJ&#39;, &#39;1356853149054377&#39;, &#39;length&#39;, &#39;slice&#39;, &#39;1720848ZSQDkr&#39;]
</code></pre></div>
ä½†æ˜¯åœ¨ Console é‡Œé¢è°ƒç”¨ _0x381b å¾—åˆ°çš„å´æ˜¯ä»¥ 'slice' å¼€å¤´ã€'length' ç»“å°¾çš„åˆ—è¡¨ï¼Œå°†è¿™ä¸ªåˆ—è¡¨è®°ä¸º lst æ–¹ä¾¿è¡¨è¿°<br/>
è€Œä¸”æºç ä¸­åªæœ‰æœ€å¼€å¤´çš„è°ƒç”¨åŒ¿åå‡½æ•°é‡Œé¢æœ‰ <code>['push']</code> å’Œ <code>['shift']</code>ï¼Œæ‰€ä»¥æ¨æµ‹è¿™ä¸ªåŒ¿åå‡½æ•°å°±æ˜¯å°†è¿™ä¸ªåˆ—è¡¨å¾ªç¯å³ç§»ä¸¤ä¸ªä½ç½®<br/>
é‚£è¿™ä¸ªåŒ¿åå‡½æ•°ä¹Ÿä¸ç”¨çœ‹äº†</p>
<p>å†æ¥çœ‹ <code>_0x2c9e()</code> è¿™ä¸ªå‡½æ•°ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="__codelineno-23-1"></a><span class="kd">function</span> <span class="nx">_0x2c9e</span><span class="p">(</span><span class="nx">_0x49e6ff</span><span class="p">,</span> <span class="nx">_0x310d40</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="__codelineno-23-2"></a>    <span class="kd">const</span> <span class="nx">_0x381b4c</span> <span class="o">=</span> <span class="nx">_0x381b</span><span class="p">();</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="__codelineno-23-3"></a>    <span class="k">return</span> <span class="nx">_0x2c9e</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_0x2c9ec6</span><span class="p">,</span> <span class="nx">_0x2ec3bd</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="__codelineno-23-4"></a>        <span class="nx">_0x2c9ec6</span> <span class="o">=</span> <span class="nx">_0x2c9ec6</span> <span class="o">-</span> <span class="mh">0x1a6</span><span class="p">;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="__codelineno-23-5"></a>        <span class="kd">let</span> <span class="nx">_0x4769df</span> <span class="o">=</span> <span class="nx">_0x381b4c</span><span class="p">[</span><span class="nx">_0x2c9ec6</span><span class="p">];</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="__codelineno-23-6"></a>        <span class="k">return</span> <span class="nx">_0x4769df</span><span class="p">;</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="__codelineno-23-7"></a>    <span class="p">}</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="__codelineno-23-8"></a>    <span class="p">,</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="__codelineno-23-9"></a>    <span class="nx">_0x2c9e</span><span class="p">(</span><span class="nx">_0x49e6ff</span><span class="p">,</span> <span class="nx">_0x310d40</span><span class="p">);</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="__codelineno-23-10"></a><span class="p">}</span>
</code></pre></div>
å…¶ä¸­ <code>_0x381b4c</code> æ˜¯åˆšåˆšè¯´çš„é‚£ä¸ªåˆ—è¡¨ lstã€‚ç„¶å return é‡Œé¢é‡æ–°å®šä¹‰äº† <code>_0x2c9e</code>ï¼Œä½†æ˜¯æ–°çš„å®šä¹‰é‡Œç¬¬äºŒä¸ªå‚æ•°å¹¶æ²¡æœ‰ç”¨ï¼Œç„¶åè°ƒç”¨è¿”å›ï¼Œæ‰€ä»¥æ•´ä¸ªå‡½æ•°å°±ç›¸å½“äºï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="__codelineno-24-1"></a><span class="kd">function</span> <span class="nx">_0x2c9e</span><span class="p">(</span><span class="nx">_0x2c9ec6</span><span class="p">,</span> <span class="p">...)</span> <span class="p">{</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="__codelineno-24-2"></a>    <span class="nx">_0x2c9ec6</span> <span class="o">=</span> <span class="nx">_0x2c9ec6</span> <span class="o">-</span> <span class="mh">0x1a6</span><span class="p">;</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="__codelineno-24-3"></a>    <span class="k">return</span> <span class="nx">lst</span><span class="p">[</span><span class="nx">_0x2c9ec6</span><span class="p">];</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="__codelineno-24-4"></a><span class="p">}</span>
</code></pre></div>
0x1a6 æ˜¯ 422ï¼Œæ‰€ä»¥æ•´ä¸ªå‡½æ•°ä¹Ÿå°±ç›¸å½“äº function(x) { return lst[x - 422]; }<br/>
åŒæ—¶æ ¹æ®ç¬¬ä¸€è¡Œï¼Œç¨‹åºä¸­æ‰€æœ‰ <code>_0x22517d</code> ä¹Ÿæ˜¯è¿™ä¸ªå‡½æ•°</p>
<p>ç„¶åçœ‹åˆ¤æ–­ç­”æ¡ˆçš„ <code>gyflagh</code> å‡½æ•°
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="__codelineno-25-1"></a><span class="kd">function</span> <span class="nx">gyflagh</span><span class="p">(</span><span class="nx">_0x111955</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="__codelineno-25-2"></a>    <span class="kd">const</span> <span class="nx">_0x50051f</span> <span class="o">=</span> <span class="nx">_0x22517d</span><span class="p">;</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="__codelineno-25-3"></a>    <span class="kd">let</span> <span class="nx">_0x3b790d</span> <span class="o">=</span> <span class="nx">_0x111955</span><span class="p">[</span><span class="nx">_0x50051f</span><span class="p">(</span><span class="mh">0x1a8</span><span class="p">)](</span><span class="nx">_0x50051f</span><span class="p">(</span><span class="mh">0x1b7</span><span class="p">));</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="__codelineno-25-4"></a>    <span class="k">if</span> <span class="p">(</span><span class="nx">_0x3b790d</span> <span class="o">===</span> <span class="nx">_0x50051f</span><span class="p">(</span><span class="mh">0x1aa</span><span class="p">))</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="__codelineno-25-5"></a>        <span class="k">return</span> <span class="o">!!</span><span class="p">[];</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="__codelineno-25-6"></a>    <span class="k">return</span> <span class="o">!</span><span class="p">[];</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="__codelineno-25-7"></a><span class="p">}</span>
</code></pre></div>
æ²¡å•¥ç‰¹åˆ«çš„ï¼Œç»“åˆ lst å¯ä»¥å¾—åˆ°ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="__codelineno-26-1"></a><span class="kd">function</span> <span class="nx">gyflagh</span><span class="p">(</span><span class="nx">ans</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="__codelineno-26-2"></a>  <span class="k">if</span> <span class="p">(</span><span class="nx">ans</span><span class="p">[</span><span class="s2">&quot;encrypt&quot;</span><span class="p">](</span><span class="s2">&quot;1356853149054377&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c&quot;</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="__codelineno-26-3"></a>    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="__codelineno-26-4"></a>  <span class="p">}</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="__codelineno-26-5"></a>  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="__codelineno-26-6"></a><span class="p">}</span>
</code></pre></div></p>
<p>ç„¶åå°±å¯ä»¥ç»“åˆ lst ä¸­çš„å€¼å’Œç´¢å¼•ï¼Œç¿»è¯‘å‡ºæœ€é‡è¦çš„å‡½æ•°<br/>
å†è¿›è¡Œä¸€äº›è¿ç®—ï¼Œç”¨æ³¨é‡Šæ ‡æ³¨ä¸€ä¸‹å·²çŸ¥çš„å€¼å°±å¯ä»¥å¾—åˆ°ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="__codelineno-27-1"></a><span class="nb">String</span><span class="p">[</span><span class="s2">&quot;prototype&quot;</span><span class="p">][</span><span class="s2">&quot;encrypt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// key = &quot;1356853149054377&quot;</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="__codelineno-27-2"></a>    <span class="kd">const</span> <span class="nx">left</span> <span class="o">=</span> <span class="ow">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="__codelineno-27-3"></a>    <span class="kd">const</span> <span class="nx">right</span> <span class="o">=</span> <span class="ow">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mf">4</span><span class="p">);</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="__codelineno-27-4"></a>    <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="__codelineno-27-5"></a>    <span class="nx">ans</span> <span class="o">=</span> <span class="nx">escape</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this := ans</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="__codelineno-27-6"></a>    <span class="nx">right</span> <span class="o">=</span> <span class="p">[</span><span class="mf">909456177</span><span class="p">,</span> <span class="mf">825439544</span><span class="p">,</span> <span class="mf">892352820</span><span class="p">,</span> <span class="mf">926364468</span><span class="p">]</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="__codelineno-27-7"></a>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ans</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">];</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mf">8</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="__codelineno-27-8"></a>      <span class="nx">left</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Str4ToLong</span><span class="p">(</span><span class="nx">ans</span><span class="p">[</span><span class="s2">&quot;slice&quot;</span><span class="p">](</span><span class="nx">i</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mf">4</span><span class="p">));</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="__codelineno-27-9"></a>      <span class="nx">left</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Str4ToLong</span><span class="p">(</span><span class="nx">ans</span><span class="p">[</span><span class="s2">&quot;slice&quot;</span><span class="p">](</span><span class="nx">i</span> <span class="o">+</span> <span class="mf">4</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mf">8</span><span class="p">));</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="__codelineno-27-10"></a>      <span class="nx">code</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">right</span><span class="p">);</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="__codelineno-27-11"></a>      <span class="nx">res</span> <span class="o">=</span> <span class="nx">res</span> <span class="o">+</span> <span class="p">(</span><span class="nx">LongToBase16</span><span class="p">(</span><span class="nx">left</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">+</span> <span class="nx">LongToBase16</span><span class="p">(</span><span class="nx">left</span><span class="p">[</span><span class="mf">1</span><span class="p">]));</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="__codelineno-27-12"></a>    <span class="p">}</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="__codelineno-27-13"></a>    <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>  <span class="c1">// 6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="__codelineno-27-14"></a><span class="p">};</span>
</code></pre></div></p>
<p>å†æ¥çœ‹ <code>code</code> å‡½æ•°ï¼Œæ ¹æ® &lt;&lt; 4ã€ ^ã€ &gt;&gt;&gt; 5 å¯ä»¥å¤§èƒ†æ¨æµ‹ç±»ä¼¼ TEAï¼Œç„¶åè§£ç å°±ç›´æ¥ç¿»è¿‡æ¥å°±å¥½äº†ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="__codelineno-28-1"></a><span class="kd">function</span> <span class="nx">dec</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="__codelineno-28-2"></a>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">2654435769</span> <span class="o">*</span> <span class="mf">32</span><span class="p">;</span> <span class="nx">i</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">;)</span> <span class="p">{</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="__codelineno-28-3"></a>        <span class="nx">left</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-=</span> <span class="p">((</span><span class="nx">left</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mf">4</span> <span class="o">^</span> <span class="nx">left</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="mf">5</span><span class="p">)</span> <span class="o">+</span> <span class="nx">left</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">^</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">right</span><span class="p">[</span><span class="nx">i</span> <span class="o">&gt;&gt;&gt;</span> <span class="mf">11</span> <span class="o">&amp;</span> <span class="mf">3</span><span class="p">]);</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="__codelineno-28-4"></a>        <span class="nx">i</span> <span class="o">-=</span> <span class="mf">2654435769</span><span class="p">;</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="__codelineno-28-5"></a>        <span class="nx">left</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-=</span> <span class="p">((</span><span class="nx">left</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mf">4</span> <span class="o">^</span> <span class="nx">left</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="mf">5</span><span class="p">)</span> <span class="o">+</span> <span class="nx">left</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">^</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">right</span><span class="p">[</span><span class="nx">i</span> <span class="o">&amp;</span> <span class="mf">3</span><span class="p">]);</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="__codelineno-28-6"></a>    <span class="p">}</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="__codelineno-28-7"></a>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">left</span><span class="p">);</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="__codelineno-28-8"></a><span class="p">}</span>
</code></pre></div></p>
<p>æœ€åæŠŠè¦å¾—åˆ°çš„ res åˆ†å—ï¼Œæ¯ 8 ä¸ªä¸€ç»„ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="__codelineno-29-1"></a>6fbde674 819a59bf a1209256 5b4ca2a7 a11dc670 c678681d af4afb67 04b82f0c
</code></pre></div>
ç„¶åä»åå¾€å‰ï¼Œæ¯ä¸¤ä¸ªæ‰§è¡Œ Base16ToLongï¼Œç„¶åä½œä¸º left ä¼ ç»™ dec å‡½æ•°è§£ç ï¼Œç„¶åå† LongToStr4 å¾—åˆ°å››ä¸ªå­—ç¬¦:
<img alt="" src="/assets/images/writeups/hackergame2021/minecRaft.jpg" />
æ‹¼èµ·æ¥å°±æ˜¯ flag äº†ï¼š<code>flag{McWebRE_inMlnCrA1t_3a5y_1cIuop9i}</code></p>
<hr />
<h2 id="_13">å¯†ç ç”Ÿæˆå™¨<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" />
<img alt="" src="https://img.shields.io/badge/-REVERSE-inactive?style=flat-square" /></p>
<blockquote>
<p>å° T æœ€è¿‘åˆå†™äº†ä¸€ä¸ª web åº”ç”¨ã€‚</p>
<p>ä»–å‘ç°å¾ˆå¤šç”¨æˆ·éƒ½å–œæ¬¢è®¾ç½®å¼±å¯†ç ï¼Œäºæ˜¯å†³å®šè®©æ‰€æœ‰ç”¨æˆ·çš„å¯†ç éƒ½å¿…é¡»æ˜¯ 16 ä½é•¿ï¼Œå¹¶ä¸”å„ç§ç¬¦å·éƒ½è¦æœ‰ã€‚ä¸ºäº†è®©å¤§å®¶å¯ä»¥æ–¹ä¾¿ç”Ÿæˆè¿™æ ·çš„å¯†ç ï¼Œä»–è¿˜å†™äº†ä¸€ä¸ªå¯†ç ç”Ÿæˆå™¨ï¼Œè®©ç”¨æˆ·å¯ä»¥ç”Ÿæˆç¬¦åˆè§„åˆ™çš„å¯†ç ã€‚</p>
<p>ä½†è¿™æ ·æœçœŸå®‰å…¨å—ï¼Ÿ</p>
</blockquote>
<p>ï¼ˆæ„Ÿè§‰è¿™æ¬¡ Hackergame é¢˜çš„ tag éƒ½å¾ˆè¯¡å¼‚ã€‚è¿™é¢˜æ˜æ˜æ˜¯ misc(general) ä¸ºä»€ä¹ˆæ‰“äº† binary çš„ tagï¼‰</p>
<p>çœ‹åˆ° binary tag ç›´æ¥å…ˆå¾€ IDA é‡Œé¢ä¸¢ï¼Œç„¶åæŠ¥é”™äº†ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºéƒ¨åˆ† winapi å¯¼å…¥ä¸è¿›å»çš„é—®é¢˜ï¼ˆï¼Ÿï¼‰<br/>
ç„¶åå°±ä¸ä¼šäº†â€¦â€¦ å¯¹ç€ IDA å¹²çªçœ¼</p>
<p>çœ‹é¢˜ï¼Œé¢˜ç›®ç»™äº†ä¸€ä¸ªç½‘ç«™ï¼Œç”¨æ¥å‘å¸ƒå±•æ¿ï¼Œçœ‹èµ·æ¥åªæœ‰ admin ç”¨æˆ·ï¼Œè€Œä¸”æ²¡æœ‰æ³¨å†Œç³»ç»Ÿï¼Œæ‰€ä»¥åº”è¯¥å°±æ˜¯è¦æåˆ° admin çš„å¯†ç äº†<br/>
å†ç»†çœ‹ç½‘ç«™ï¼Œç‰¹æ„æåˆ° â€œç½‘é¡µæ˜¾ç¤º<strong>æ—¶é—´</strong>â€ï¼Œè€Œä¸”å±•æ¿åé¢éƒ½æœ‰å‘å¸ƒæ—¶é—´ï¼Œç‚¹è¿› admin çš„ç”¨æˆ·é¡µé¢å‘ç°ä¹Ÿæœ‰æ³¨å†Œæ—¶é—´ï¼Œç€å®æœ‰äº›è®¸è¯¡å¼‚ï¼ˆ<br/>
æ‰€ä»¥æ—¶é—´åº”è¯¥æ˜¯ä¸€ä¸ªæç¤º</p>
<p>è€Œå†™ä»£ç çš„æ—¶å€™è®¾ç½®éšæœºæ•°ç§å­åˆå¸¸ä»¥å½“å‰æ—¶é—´ä½œä¸ºç§å­ï¼Œæ‰€ä»¥ç”Ÿæˆçš„å¯†ç å¯èƒ½æ˜¯å’Œæ—¶é—´æœ‰å…³ç³»çš„<br/>
é€šè¿‡è°ƒç³»ç»Ÿæ—¶é—´ï¼Œå¯ä»¥å‘ç°åœ¨åŒä¸€ç§’ç‚¹ä¸‹ç”Ÿæˆï¼Œäº§ç”Ÿçš„å¯†ç æ˜¯ä¸€æ ·çš„<br/>
æ‰€ä»¥åªéœ€è¦æŠŠç³»ç»Ÿæ—¶é—´è°ƒåˆ° admin çš„æ³¨å†Œæ—¶é—´å·¦å³ï¼Œç„¶åæ¯ç§’ç”Ÿæˆå¯†ç ï¼Œå†æŒ¨ä¸ªè¾“è¿›å»çˆ†ç ´å³å¯</p>
<p>æœ€åå¾—åˆ° 2021-09-22 23:10:53 æ—¶ç”Ÿæˆçš„å¯†ç  <code>$Z=CBDL7TjHu~mEX</code> å°±æ˜¯ admin çš„å¯†ç <br/>
ç„¶åç™»å½•å³å¯åœ¨â€œæˆ‘çš„â€é‡Œçœ‹åˆ°ä¸€æ¡ç§å¯†å±•æ¿ï¼Œå†…å®¹æ˜¯ flag</p>
<hr />
<h2 id="pq">pğŸ˜­q<a class="headerlink" href="#pq" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://img.shields.io/badge/-MISC-informational?style=flat-square" /></p>
<blockquote>
<p>å­¦ä¼šå‚…é‡Œå¶çš„ä¸€ç¬é—´ï¼Œæ‚”æ¨çš„æ³ªæ°´æµäº†ä¸‹æ¥ã€‚</p>
<p>å½“æˆ‘çœ‹åˆ°éŸ³é¢‘æ’­æ”¾å™¨ä¸­è·³åŠ¨çš„é¢‘è°±åŠ¨ç”»ï¼Œæœˆæ˜æ˜Ÿç¨€çš„å¤œæ™šï¼Œæ·±é‚ƒçš„é“¶æ²³ï¼Œåªæœ‰å¤©ä½¿åœ¨æµ…åŸä½å”±ï¼Œå¤æ‚çš„æƒ…æ„Ÿäºæˆ‘çœ¼ä¸­æº¢å‡ºï¼Œåƒæ˜¯æ²‰å…¥äº†é›¾é‡Œæœ¦èƒ§çš„æµ·ä¸€æ ·çš„æ¸©æŸ”ã€‚</p>
<p>è¿™ä¸€åˆ»æˆ‘æ‰çŸ¥é“ï¼Œè€³æœºéŸ³å“ä¹Ÿå°±å›¾ä¸€ä¹ï¼ŒçœŸå¬éŸ³ä¹è¿˜å¾—é çœ¼ç›ã€‚</p>
<p>ï¼ˆæ³¨æ„ï¼šflag èŠ±æ‹¬å·å†…æ˜¯ä¸€ä¸ª 12 ä½æ•´æ•°ï¼Œç”± 0-9 æ•°ä½ç»„æˆï¼Œæ²¡æœ‰å…¶å®ƒå­—ç¬¦ã€‚ï¼‰</p>
</blockquote>
<p>è™½ç„¶è¿™é¢˜æ˜¯åœ¨å€’æ•°ç¬¬ä¸‰é¢˜ï¼Œè¿˜å€¼ 400ptï¼Œ<del>ä½†ä½ ä¸€è¯´å‚…é‡Œå¶æˆ‘å¯å°±ä¸å›°äº†å—·</del></p>
<p>ä¸‹è½½é¢˜ç›®åŒ…ï¼Œæœ‰ä¸€ä¸ªç”Ÿæˆ gif çš„ py ä»£ç å’Œé‚£ä¸ª gif æ–‡ä»¶<br/>
æ­£å¥½å‰é¢çš„ç”µæ³¢ä¹Ÿæœ‰ä¸€æ®µéŸ³é¢‘ï¼Œå¯ä»¥ç”¨é‚£ä¸ªå¸¦å…¥åˆ° generate_sound_visualization.py ä¸­ç”Ÿæˆä¸€ä¸ª gifï¼Œç„¶åç”¨è¿™ä¸ªæ¥æµ‹è¯•</p>
<p>å†ä»”ç»†çœ‹ä¸€çœ‹ generate_sound_visualization.py è¿™ä¸ªæ–‡ä»¶<br/>
ä¸»è¦ä½¿ç”¨äº† <code>librosa</code>ï¼Œäºæ˜¯å°±å¯ä»¥ç¿»<a href="https://librosa.org/doc/latest/index.html">æ–‡æ¡£</a>æ¥çœ‹æ‡‚è¿™ä¸ªç¨‹åºï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="__codelineno-30-1"></a><span class="n">y</span><span class="p">,</span> <span class="n">sample_rate</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;flag.mp3&quot;</span><span class="p">)</span> <span class="c1"># ä»mp3ä¸­è¯»å–æ•°æ®å’Œé‡‡æ ·ç‡</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="__codelineno-30-3"></a><span class="n">spectrogram</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">around</span><span class="p">(</span> <span class="c1"># å››èˆäº”å…¥ï¼Œä½†ä¼šé€ æˆé€†å‘çš„æ—¶å€™æœ‰å°‘è®¸è¯¯å·®å¯¼è‡´æ‚éŸ³</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="__codelineno-30-4"></a>    <span class="n">librosa</span><span class="o">.</span><span class="n">power_to_db</span><span class="p">(</span> <span class="c1"># æŠŠä»¥åŠŸç‡ä¸ºå•ä½çš„é¢‘è°±å›¾è½¬æ¢ä¸ºä»¥åˆ†è´ä¸ºå•ä½</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="__codelineno-30-5"></a>        <span class="n">librosa</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">melspectrogram</span><span class="p">(</span> <span class="c1"># é€šè¿‡éŸ³é¢‘æ•°æ®å’Œé‡‡æ ·ç‡è®¡ç®—æ¢…å°”é¢‘è°±</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="__codelineno-30-6"></a>            <span class="n">y</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">,</span> <span class="n">n_mels</span><span class="o">=</span><span class="n">num_freqs</span><span class="p">,</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="__codelineno-30-7"></a>            <span class="n">n_fft</span><span class="o">=</span><span class="n">fft_window_size</span><span class="p">,</span> 
<a id="__codelineno-30-8" name="__codelineno-30-8" href="__codelineno-30-8"></a>            <span class="n">hop_length</span><span class="o">=</span><span class="n">frame_step_size</span><span class="p">,</span> 
<a id="__codelineno-30-9" name="__codelineno-30-9" href="__codelineno-30-9"></a>            <span class="n">window</span><span class="o">=</span><span class="n">window_function_type</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="__codelineno-30-10"></a>        <span class="p">)</span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="__codelineno-30-11"></a>    <span class="p">)</span> <span class="o">/</span> <span class="n">quantize</span> <span class="c1"># é™¤ä»¥2</span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="__codelineno-30-12"></a><span class="p">)</span> <span class="o">*</span> <span class="n">quantize</span> <span class="c1"># ä¹˜ä»¥2</span>
</code></pre></div></p>
<p>ç„¶ååˆé€šè¿‡ä¸€äº› <code>numpy</code> çš„éªšæ“ä½œæ¥ç”Ÿæˆæ¯ä¸€å¸§çš„æ•°æ®ï¼Œç„¶åé€šè¿‡ <code>array2gif</code> åŒ…çš„ write_gif å‡½æ•°æ¥ç”Ÿæˆ gif </p>
<p>æ‰€ä»¥ä¸»è¦æ€è·¯å°±æ˜¯æŠŠæ•´ä¸ªç¨‹åº<strong>å®Œæ•´åœ°é€†è¿‡æ¥</strong></p>
<p>ç”±äºå¿…åº”æ²¡æœ‰æŸ¥åˆ° <code>gif2array</code> çš„åŒ…ï¼Œæ‰€ä»¥è¯»å– gif å°±ç”¨äº†ç»å…¸ <code>PIL.Image</code>ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="__codelineno-31-1"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="__codelineno-31-2"></a><span class="n">file</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;flag.gif&quot;</span><span class="p">)</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="__codelineno-31-3"></a>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="__codelineno-31-4"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="__codelineno-31-5"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="__codelineno-31-6"></a>        <span class="n">gif_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="__codelineno-31-7"></a>        <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="__codelineno-31-8"></a><span class="k">except</span><span class="p">:</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="__codelineno-31-9"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+] Read gif file&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p>ç„¶åæ˜¯è§£å†³é‚£ä¸€å¤§æ®µ numpy éªšæ“ä½œçš„é€†éªšæ“ä½œï¼ˆ<br/>
ä½†æ˜¯æ•°ç†åŸºç¡€è¿™ä¹ˆå·®çš„æˆ‘å½“ç„¶æ˜¯ä¸æƒ³ä»”ç»†ç ”ç©¶äº†ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ç”µæ³¢é‚£é¢˜çš„ radio.mp3 å¸¦å…¥ï¼Œçœ‹ä¸€çœ‹è¦å¾—åˆ°çš„ spectrogram æ˜¯ä»€ä¹ˆæ ·å­<br/>
è¾“å‡ºå¾—åˆ°çš„ spectrogram æ˜¯ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="__codelineno-32-1"></a><span class="p">[[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">48.</span> <span class="o">-</span><span class="mf">30.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="__codelineno-32-2"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">44.</span> <span class="o">-</span><span class="mf">26.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="__codelineno-32-3"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">40.</span> <span class="o">-</span><span class="mf">16.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="__codelineno-32-4"></a> <span class="o">...</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="__codelineno-32-5"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">42.</span> <span class="o">-</span><span class="mf">30.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="__codelineno-32-6"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">44.</span> <span class="o">-</span><span class="mf">32.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="__codelineno-32-7"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">46.</span> <span class="o">-</span><span class="mf">34.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]]</span>
</code></pre></div>
è€Œè½¬ç½®è¿‡æ¥æ˜¯ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="__codelineno-33-1"></a><span class="p">[[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="__codelineno-33-2"></a> <span class="p">[</span><span class="o">-</span><span class="mf">48.</span> <span class="o">-</span><span class="mf">44.</span> <span class="o">-</span><span class="mf">40.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">42.</span> <span class="o">-</span><span class="mf">44.</span> <span class="o">-</span><span class="mf">46.</span><span class="p">]</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="__codelineno-33-3"></a> <span class="p">[</span><span class="o">-</span><span class="mf">30.</span> <span class="o">-</span><span class="mf">26.</span> <span class="o">-</span><span class="mf">16.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">30.</span> <span class="o">-</span><span class="mf">32.</span> <span class="o">-</span><span class="mf">34.</span><span class="p">]</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="__codelineno-33-4"></a> <span class="o">...</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="__codelineno-33-5"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="__codelineno-33-6"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="__codelineno-33-7"></a> <span class="p">[</span><span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">...</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span> <span class="o">-</span><span class="mf">58.</span><span class="p">]]</span>
</code></pre></div>
å‡å» min_db=-60 ç¬¬ä¸€è¡Œæ­£å¥½æ˜¯ 2ï¼Œç¬¬äºŒè¡Œæ˜¯ [12. 16. 20. ... 18. 16. 14.]<br/>
å†å¯¹åº”åˆ°ç”Ÿæˆçš„ gif æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹å‡º gif çš„ç¬¬ä¸€å¸§æ¯ä¸ªçŸ©å½¢çš„é«˜åº¦éƒ½æ˜¯ 2<br/>
è€Œç¬¬äºŒå¸§æ¯ä¸ªçŸ©å½¢çš„é«˜åº¦ä¹Ÿæ°å¥½æ˜¯åˆšå¾—å‡ºçš„é‚£ç»„æ•°<br/>
æ‰€ä»¥è¦å¾—åˆ°çš„ spectrogram å°±æ˜¯ <strong>gif æ¯ä¸€å¸§æ‰€æœ‰çŸ©å½¢çš„é«˜åº¦æ„æˆçš„çŸ©é˜µçš„è½¬ç½®</strong></p>
<p>å†ç»“åˆæºç ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="__codelineno-34-1"></a><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="__codelineno-34-2"></a>    <span class="p">[</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="__codelineno-34-3"></a>        <span class="n">red_pixel</span> <span class="k">if</span> <span class="n">freq</span> <span class="o">%</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">round</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">freq</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="n">white_pixel</span> 
<a id="__codelineno-34-4" name="__codelineno-34-4" href="__codelineno-34-4"></a>        <span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">min_db</span><span class="p">,</span> <span class="n">max_db</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">quantize</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="__codelineno-34-5"></a>    <span class="p">]</span> 
<a id="__codelineno-34-6" name="__codelineno-34-6" href="__codelineno-34-6"></a>    <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_freqs</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="__codelineno-34-7"></a><span class="p">])</span>
</code></pre></div>
å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªçŸ©å½¢åŠ ä¸Šå·¦è¾¹çš„ç©ºæ ¼æ­£å¥½æ˜¯ 4 ä¸ªåƒç´ ï¼Œæ‰€ä»¥æ¯å››åˆ—è¯»å–æœ€åä¸€åˆ—å³å¯ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="__codelineno-35-1"></a><span class="n">spectrogramT</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="__codelineno-35-2"></a><span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">gif_data</span><span class="p">:</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="__codelineno-35-3"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="__codelineno-35-4"></a>    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">()):</span> <span class="c1"># å°†æ¯ä¸€å¸§è½¬ç½®ï¼Œæ–¹ä¾¿è®¡ç®—</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="__codelineno-35-5"></a>        <span class="n">num</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="c1"># è®¡ç®—æ¯ä¸ªçŸ©å½¢çš„é«˜åº¦ï¼ˆè½¬ç½®åæ˜¯å®½åº¦ï¼‰</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="__codelineno-35-6"></a>        <span class="k">if</span> <span class="n">ind</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="__codelineno-35-7"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span> <span class="o">+</span> <span class="n">min_db</span><span class="p">)</span> <span class="c1"># å¾—åˆ°çš„æ•°è¦åŠ ä¸Š-60æ‰ç¬¦åˆè§„çŸ©</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="__codelineno-35-8"></a>    <span class="n">spectrogramT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="__codelineno-35-9"></a>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="__codelineno-35-10"></a><span class="n">spectrogram</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spectrogramT</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># å¾—åˆ°çš„ç»“æœè½¬ç½®ä¸€ä¸‹</span>
</code></pre></div></p>
<p>è¿™æ ·å°±å¾—åˆ°äº†æ¢…å°”é¢‘è°±å›¾çš„æ•°æ®ï¼Œå¯ä»¥å¯¹ librosa çš„éƒ¨åˆ†è¿›è¡Œé€†è¿‡ç¨‹äº†<br/>
ç¿» librosa çš„æ–‡æ¡£ï¼Œæœ‰ <code>power_to_db</code> å½“ç„¶ä¹Ÿå°±æœ‰ <code>db_to_power</code><br/>
è€Œä¸”ç±»ä¼¼äº melspectrogram å‡½æ•°åœ¨ librosa.feature ä¸­ï¼Œå¯ä»¥ä¸“é—¨çœ‹ <a href="https://librosa.org/doc/latest/feature.html">feature éƒ¨åˆ†çš„æ–‡æ¡£</a><br/>
ç¿»åˆ°äº† inverse éƒ¨åˆ†ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªå‡½æ•° <code>librosa.feature.inverse.mel_to_audio</code> å¯ä»¥ç›´æ¥æŠŠæ¢…å°”é¢‘è°±å›¾ä¸“ä¸ºéŸ³é¢‘æ•°æ®ï¼Œæ‰€ä»¥å°±ç”¨å®ƒäº†ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="__codelineno-36-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">inverse</span><span class="o">.</span><span class="n">mel_to_audio</span><span class="p">(</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="__codelineno-36-2"></a>    <span class="n">librosa</span><span class="o">.</span><span class="n">db_to_power</span><span class="p">(</span><span class="n">spectrogram</span><span class="p">),</span> <span class="c1"># ä¹˜äºŒé™¤äºŒæ²¡ä»€ä¹ˆå¤§ç”¨ï¼Œè€Œä¸”å½±å“æ•ˆæœï¼Œå°±åˆ äº†</span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="__codelineno-36-3"></a>    <span class="n">sample_rate</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">num_freqs</span><span class="p">,</span> <span class="c1"># é‡‡æ ·ç‡é¢˜ç›®æä¾›äº†ï¼Œæ˜¯ 22050Hz</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="__codelineno-36-4"></a>    <span class="n">n_fft</span><span class="o">=</span><span class="n">fft_window_size</span><span class="p">,</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="__codelineno-36-5"></a>    <span class="n">hop_length</span><span class="o">=</span><span class="n">frame_step_size</span><span class="p">,</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="__codelineno-36-6"></a>    <span class="n">window</span><span class="o">=</span><span class="n">window_function_type</span><span class="p">,</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="__codelineno-36-7"></a><span class="p">)</span>
</code></pre></div></p>
<p>è¿™æ ·å°±å®Œæˆäº†è¿˜åŸï¼Œæœ€åæ˜¯è¾“å‡ºï¼Œä½†æ˜¯å¹¶æ²¡åœ¨ librosa ä¸­æ‰¾åˆ°éŸ³é¢‘è¾“å‡ºçš„å‡½æ•°ï¼Œæ‰€ä»¥å°±ç”¨äº†ç»å…¸ <code>soundfile</code>ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="__codelineno-37-1"></a><span class="kn">import</span> <span class="nn">soundfile</span> <span class="k">as</span> <span class="nn">sf</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="__codelineno-37-2"></a><span class="n">sf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;flag.wav&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">)</span>
</code></pre></div></p>
<p>ç„¶åæ‰“å¼€å¬å°±è¡Œäº†ï¼Œé¢˜ç›®è¯´äº†æ˜¯ä¸ª 12 ä½æ•°ï¼Œæ‰€ä»¥å‰©ä¸‹çš„å°±æ˜¯è‹±è¯­å¬åŠ›äº†ï¼Œç¿»è¯‘è¿‡æ¥çš„æ•°å­—å°±æ˜¯ flag äº† </p>
<hr />
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://hack.lug.ustc.edu.cn/">Hackergame</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/101866561">å›½é™…èˆªç©ºæ— çº¿ç”µé€šè®¯26ä¸ªè‹±æ–‡å­—æ¯è¯»æ³• - çŸ¥ä¹</a></li>
<li><a href="https://lug.ustc.edu.cn/">LUG@USTC å®˜ç½‘</a></li>
<li><a href="https://archive.org">Wayback Machine archive.org</a></li>
<li><a href="http://sigbovik.org/2021/proceedings.pdf">SIGBOVIK 2021</a></li>
<li><a href="http://quanjing.baidu.com/">ç™¾åº¦å…¨æ™¯åœ°å›¾</a></li>
<li><a href="https://www.cnblogs.com/holdon521/p/4686849.html">ä¼ªé€ httpè¯·æ±‚ipåœ°å€ - åšå®¢å›­</a></li>
<li><a href="https://graphql.cn/">GraphQLå®˜ç½‘</a>ã€<a href="https://www.electronjs.org/apps/graphiql">GraphiQL</a>ã€<a href="https://apis.guru/graphql-voyager/">GraphQL Voyager</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/390876937">ã€å®‰å…¨è®°å½•ã€‘ç©è½¬GraphQL - DVGAé¶åœºï¼ˆä¸Šï¼‰- çŸ¥ä¹</a></li>
<li><a href="https://librosa.org/doc/latest/index.html">librosaæ–‡æ¡£</a></li>
<li><a href="https://pysoundfile.readthedocs.io/en/latest/">PySoundFileæ–‡æ¡£</a></li>
<li><a href="https://en.wikipedia.org/wiki/Wilson's_theorem">Wilson's theorem - wikipedia</a></li>
<li><a href="https://blog.csdn.net/xiao_han_a/article/details/118974504">BUU-RSA [RoarCTF2019]babyRSA - CSDN</a></li>
<li><a href="https://en.wikipedia.org/wiki/Euler%27s_totient_function">Euler's totient function - wikipedia</a></li>
<li><a href="https://gitlab.com/cryptsetup/LUKS2-docs/blob/master/luks2_doc_wip.pdf">LUKS2 doc pdf</a></li>
<li><a href="https://www.thegeekstuff.com/2016/03/cryptsetup-lukskey/">10 Linux cryptsetup Examples for LUKS Key Management</a></li>
<li><a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a></li>
<li><a href="https://github.com/rocky/python-uncompyle6/">uncompyle6</a></li>
</ul>

  
    <hr>
<div class="md-source-file">
  <small>
    
      æœ€åæ›´æ–°:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2022å¹´6æœˆ17æ—¥ 21:09:09</span>
      
        <br>
        åˆ›å»ºæ—¥æœŸ:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2022å¹´1æœˆ6æ—¥ 23:08:19</span>
      
    
  </small>
</div>
  

                  
                    <script src="https://giscus.app/client.js"
                            data-repo="TonyCrane/note"
                            data-repo-id="R_kgDOGnfbUQ"
                            data-category="General"
                            data-category-id="DIC_kwDOGnfbUc4CPrf4"
                            data-mapping="pathname"
                            data-reactions-enabled="1"
                            data-emit-metadata="0"
                            data-input-position="bottom"
                            data-theme="light"
                            data-lang="zh-CN"
                            crossorigin="anonymous"
                            async>
                    </script>
                    <script>
                      if (document.querySelector("body").getAttribute("data-md-color-scheme") === "slate") {
                        var giscus = document.querySelector("script[src*=giscus]")
                        giscus.setAttribute("data-theme", "https://gcore.jsdelivr.net/gh/TonyCrane/note/docs/css/giscus.css") 
                      }
                    </script>
                  
                
              </article>
            </div>
          </div>
          
            <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
              å›åˆ°é¡µé¢é¡¶éƒ¨
            </a>
          
        </main>
        
          <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="é¡µè„š">
      
        
        <a href="../sysu_msc_puzzle/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: SYSU MSC Puzzle 2021" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
              SYSU MSC Puzzle 2021
            </div>
          </div>
        </a>
      
      
        
        <a href="../d0g3/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: ç¬¬å››å±Šâ€œå®‰æ´µæ¯â€" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
              ç¬¬å››å±Šâ€œå®‰æ´µæ¯â€
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 <a href="https://github.com/TonyCrane"  target="_blank" rel="noopener">TonyCrane</a>
    </div>
  
  
    Powered by
    <a href="https://www.mkdocs.org/" target="_blank" rel="noopener">
      MkDocs
    </a>
    with theme
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material
    </a>
    modified by
    <a href="https://github.com/TonyCrane" target="_blank" rel="noopener">
      TonyCrane
    </a>
  
</div>
  
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/TonyCrane/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://blog.tonycrane.cc/" target="_blank" rel="noopener" title="blog.tonycrane.cc" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://tonycrane.cc/" target="_blank" rel="noopener" title="tonycrane.cc" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M280.37 148.26 96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47 488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
        
      </div>
      <div class="md-dialog" data-md-component="dialog">
        <div class="md-dialog__inner md-typeset"></div>
      </div>
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js"}</script>
      
      
        <script src="../../assets/javascripts/bundle.289a2a4b.min.js"></script>
        
          <script src="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
        
          <script src="../../js/katex.js"></script>
        
      
    </body>
  </html>
  