<HTML>
<HEAD>
<TITLE>Int 21/AX=4402h
</TITLE>
<META NAME="Description" CONTENT="
Int 21/AX=4402h - Network Driver Interface Specification (NDIS) 2.0.1 - PROTOCOL MANAGER - 
AX = 4402h
BX = file handle for device PROTMAN$
CX = 000Eh (size of request block)
DS:DX - request block (see #01424,#01425,#01426,#01427,#01428,#01432,#01433)
Return: CF clear if successful
AX = number of bytes actually read
CF set on error
AX = error code (01h,05h,06h,0Dh) (see #01680 at AH=59h/BX=0000h)
SeeAlso: AX=4402hFTPSOFT
">
<META NAME="robots" CONTENT="none">
</HEAD>
<BODY BGCOLOR="#FFD0A0">
<center>
<h2>Int 21/AX=4402h
</h2>
</center><p>
<table border=1 cellpadding=3 cellspacing=1>
<td>
<a href="rb-2822.htm">
<img src=./gif/lup.gif border=0 alt=Prev></a>
<a href="rb-2824.htm">
<img src=./gif/ldown.gif border=0 alt=Next></a>
<a href="../rbrown.htm">
<img src=./gif/lhome.gif border=0 alt=Ralf Brown Page></a>
<td><a href="int.htm">Interrups</a></td>
<td><a href="cat.htm">Categories</a></td>
<td><a href="alpha.htm">Contents</a></td>
</td></table><p>
<p><img src=./gif/rbline.gif width="100%" alt="------"><p>
<h3><font color=#C00040>Network Driver Interface Specification (NDIS) 2.0.1 - PROTOCOL MANAGER</font></h3>
<PRE>
AX = 4402h
BX = file handle for device "PROTMAN$"
CX = 000Eh (size of request block)
DS:DX -> request block <a href="rb-0000.htm#Table0"></a>(see #01424,#01425,#01426,#01427,#01428,#01432,#01433)<br>
<p><b>Return:</b><br>CF clear if successful
AX = number of bytes actually read
CF set on error
AX = error code (01h,05h,06h,0Dh) <a href="rb-0000.htm#Table0"></a>(see #01680 at AH=59h/BX=0000h)
</PRE>
<p><b>See Also:</b>
<a href="rb-2840.htm">AX=4402h"FTPSOFT"</a>
<PRE>
<p>
Format of NDIS request block for GetProtocolManagerInfo:
<a name=table1424></a>
Offset  Size    Description     (Table 01424)
00h    WORD    01h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   returned pointer to structure representing parsed user config
08h    DWORD   unused
0Ch    WORD    returned BCD version of NDIS on which Protocol Manager is based
</PRE>
<p><b>See Also:</b>
#01425 - #01426 - #01427 - #01428 - #01429 - #01430 - #01431 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for RegisterModule:
<a name=table1425></a>
Offset  Size    Description     (Table 01425)
00h    WORD    02h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   pointer to module's common characteristics table <a href="rb-2823.htm#Table1435">(see #01435)</a>
08h    DWORD   pointer to list of modules to which the module is to be bound
0Ch    WORD    unused
</PRE>
<p><b>See Also:</b>
#01424 - #01426 - #01427 - #01428 - #01429 - #01430 - #01431 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for BindAndStart:
<a name=table1426></a>
Offset  Size    Description     (Table 01426)
00h    WORD    03h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   caller's virtual address in FailingModules structure
08h    DWORD   unused
0Ch    WORD    unused
</PRE>
<p><b>See Also:</b>
#01424 - #01425 - #01427 - #01428 - #01429 - #01430 - #01431 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for GetProtocolManagerLinkage:
<a name=table1427></a>
Offset  Size    Description     (Table 01427)
00h    WORD    04h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   returned dispatch point
08h    DWORD   unused
0Ch    WORD    returned protocol manager DS
</PRE>
<p><b>Note:</b>
The dispatch point may be called as follows instead of using this IOCTL.
<PRE>
<p><b>STACK:</b><br>WORD  protocol manager DS
DWORD pointer to request block.
<p><b>Return:</b><br>AX = returned status
STACK popped
</PRE>
<p><b>See Also:</b>
#01424 - #01425 - #01426 - #01428 - #01429 - #01430 - #01431 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for GetProtocolIniPath:
<a name=table1428></a>
Offset  Size    Description     (Table 01428)
00h    WORD    05h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   pointer to a buffer for the ASCIZ pathname of PROTOCOL.INI
08h    DWORD   unused
0Ch    WORD    buffer length
</PRE>
<p><b>See Also:</b>
#01424 - #01425 - #01426 - #01427 - #01429 - #01430 - #01431 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for RegisterProtocolManagerInfo:
<a name=table1429></a>
Offset  Size    Description     (Table 01429)
00h    WORD    06h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   pointer to structure containing parsed user config file
08h    DWORD   unused
0Ch    WORD    length of structure
</PRE>
<p><b>See Also:</b>
#01424 - #01425 - #01426 - #01427 - #01428 - #01430 - #01431 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for InitAndRegister:
<a name=table1430></a>
Offset  Size    Description     (Table 01430)
00h    WORD    07h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   unused
08h    DWORD   poitner to ASCIZ name of the module to be prebind initialized
0Ch    WORD    unused
</PRE>
<p><b>See Also:</b>
#01424 - #01425 - #01426 - #01427 - #01428 - #01429 - #01431 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for UnbindAndStop:
<a name=table1431></a>
Offset  Size    Description     (Table 01431)
00h    WORD    08h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   failing modules as for BindAndStart
08h    DWORD   if not 0000h:0000h, pointer to ASCIZ name of module to unbind
if 0000h:0000h, terminate a set of previously dynamically
bound protocol modules
0Ch    WORD    unused
</PRE>
<p><b>See Also:</b>
#01424 - #01425 - #01426 - #01427 - #01428 - #01429 - #01430 - #01432 - #01433
<PRE>
<p>
Format of NDIS request block for BindStatus:
<a name=table1432></a>
Offset  Size    Description     (Table 01432)
00h    WORD    09h
02h    WORD    returned status <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   must be 0000h:0000h
on return, points to root tree
08h    DWORD   0000h:0000h
0Ch    WORD    unused under DOS
</PRE>
<p><b>See Also:</b>
#01424 - #01425 - #01426 - #01427 - #01428 - #01429 - #01430 - #01431 - #01433
<PRE>
<p>
Format of NDIS request block for RegisterStatus:
<a name=table1433></a>
Offset  Size    Description     (Table 01433)
00h    WORD    0Ah
02h    WORD    returned status (0000h, 0008h, 002Ch) <a href="rb-2823.htm#Table1434">(see #01434)</a>
04h    DWORD   0000h:0000h
08h    DWORD   pointer to 16-byte ASCIZ module name
0Ch    WORD    0000h
</PRE>
<p><b>Note:</b>
Not supported by the 10NET v5.0 PROTMAN$ driver
<p><b>See Also:</b>
#01424 - #01425 - #01426 - #01427 - #01428 - #01429 - #01430 - #01431 - #01432
<PRE>
<p>
<a name=table1434></a>
(Table 01434)
Values for NDIS status code:
0000h  success
0001h  wait for release--protocol has retained control of the data buffer
0002h  request queued
0003h  frame not recognized
0004h  frame rejected
0005h  frame should be forwarded
0006h  out of resource
0007h  invalid parameter
0008h  invalid function
0009h  not supported
000Ah  hardware error
000Bh  transmit error
000Ch  unrecognized destination
000Dh  buffer too small
0020h  already started
0021h  binding incomplete
0022h  driver not initialized
0023h  hardware not found
0024h  hardware failure
0025h  configuration failure
0026h  interrupt conflict
0027h  MAC incompatible
0028h  initialization failed
0029h  no binding
002Ah  network may be disconnected
002Bh  incompatible OS version
002Ch  already registered
002Dh  path not found
002Eh  insufficient memory
002Fh  info not found
00FFh  general failure
F000h-FFFFh reserved for vendor-specific codes, treated as general failure
<p>
Format of NDIS common characteristics table:
<a name=table1435></a>
Offset  Size    Description     (Table 01435)
00h    WORD    size of table in bytes
02h    BYTE    NDIS major version
03h    BYTE    NDIS minor version
04h    WORD    reserved
06h    BYTE    module major version
07h    BYTE    module minor version
08h    DWORD   module function flag bits
<p><b>bit 0:</b><br>Binding at upper boundary supported
<p><b>bit 1:</b><br>Binding at lower boundary supported
<p><b>bit 2:</b><br>Dynamically bound
bits 3-31 reserved, must be 0
0Ch 16 BYTEs   ASCIZ module name
1Ch    BYTE    upper boundary protocol level <a href="rb-2823.htm#Table1436">(see #01436)</a>
1Dh    BYTE    upper boundary interface type
<p><b>for MACs:</b><br>1 = MAC
<p><b>for data links and transports:</b><br>To be defined
<p><b>for session:</b><br>1 = NCB
<p><b>any level:</b><br>0 = private (ISV-defined)
1Eh    BYTE    lower boundary protocol level <a href="rb-2823.htm#Table1436">(see #01436)</a>
1Fh    BYTE    lower boundary interface type
same as offset 1Dh
20h    WORD    module ID filled in by protocol manager
22h    WORD    module DS
24h    DWORD   system request entry point
28h    DWORD   pointer to service-specific characteristics <a href="rb-0000.htm#Table0"></a>(see #01438,#01440)
0000h:0000h if none
2Ch    DWORD   pointer to service-specific status, or 0000h:0000h if none
<a href="rb-2823.htm#Table1441">(see #01441)</a>
30h    DWORD   pointer to upper dispatch table <a href="rb-2823.htm#Table1437">(see #01437)</a>
0000h:0000h if none
34h    DWORD   pointer to lower dispatch table <a href="rb-2823.htm#Table1437">(see #01437)</a>
0000h:0000h if none
38h  2 DWORDs  reserved, must be 0
</PRE>
<p><b>Note:</b>
For compatibility with NDIS 1.x.x, a major version of 00h is
interpreted as 01h
<PRE>
<p>
<a name=table1436></a>
(Table 01436)
Values for NDIS boundary protocol level:
00h    physical
01h    Media Access Control
02h    Data link
03h    network
04h    transport
05h    session
FFh    not specified
<p>
Format of NDIS dispatch table:
<a name=table1437></a>
Offset  Size    Description     (Table 01437)
00h    DWORD   -> common characteristics table <a href="rb-2823.htm#Table1435">(see #01435)</a>
04h  4 BYTEs   ???
08h    DWORD   -> ??? function (called with 12 bytes of stack arguments)
0Ch    DWORD   -> ??? function (called with 10 bytes of stack arguments)
10h    DWORD   -> ??? function (called with 16 bytes of stack arguments)
14h    DWORD   -> ??? function (called with 4 bytes of stack arguments)
18h    DWORD   -> ??? function (called with 18 bytes of stack arguments)
1Ch    DWORD   -> ??? function (called with 12 bytes of stack arguments)
<p>
Format of MAC Service-Specific Characteristics Table:
<a name=table1438></a>
Offset  Size    Description     (Table 01438)
00h    WORD    length of table in bytes
02h 16 BYTEs   ASCIZ MAC type name, "802.3", "802.4", "802.5", "802.6", "DIX",
"DIX+802.3", "APPLETALK", "ARCNET", "FDDI", "SDLC", "BSC",
"HDLC", or "ISDN"
12h    WORD    length of station addresses in bytes
14h 16 BYTEs   permanent station address
24h 16 BYTEs   current station address
34h    DWORD   current functional adapter address (00000000h if none)
38h    DWORD   pointer to multicast address list
3Ch    DWORD   link speed in bits/sec
40h    DWORD   service flags <a href="rb-2823.htm#Table1439">(see #01439)</a>
44h    WORD    maximum frame size which may be both sent and received
46h    DWORD   total transmit buffer capacity in bytes
4Ah    WORD    transmit buffer allocation block size in bytes
4Ch    DWORD   total receive buffer capacity in bytes
50h    WORD    receive buffer allocation block size in bytes
52h  3 BYTEs   IEEE vendor code
55h    BYTE    vendor adapter code
56h    DWORD   pointer to ASCIZ vendor adapter description
5Ah    WORD    IRQ used by adapter
5Ch    WORD    transmit queue depth
5Eh    WORD    maximum supported number of data blocks in buffer descriptors
60h  N BYTEs   vendor-specific info
</PRE>
<p><b>See Also:</b>
#01440
<PRE>
<p>
Bitfields for service flags:
<a name=table1439></a>
Bit(s)  Description     (Table 01439)
0      supports broadcast
1      supports multicast
2      supports functional/group addressing
3      supports promiscuous mode
4      station address software settable
5      statistics always current
6      supports InitiateDiagnostics
7      supports loopback
8      MAC does primarily ReceiveChain indications instead of ReceiveLookahead.
Indications
9      supports IBM source routing
10     supports MAC reset
11     supports Open/Close adapter
12     supports interrupt request
13     supports source routing bridge
14     supports GDT virtual addresses (OS/2 version)
15     multiple TransferDatas allowed durign a single indication
16     MAC normally sets FrameSize = 0 in ReceiveLookahead
17-31  reserved, must be 0
<p>
Format of NetBIOS Service-Specific Characteristics Table:
<a name=table1440></a>
Offset  Size    Description     (Table 01440)
00h    WORD    length of table in bytes
02h 16 BYTEs   ASCIZ type name of NetBIOS module
12h    WORD    NetBIOS module code
14h  N BYTEs   vendor-specific info
</PRE>
<p><b>See Also:</b>
#01438
<PRE>
<p>
Format of MAC Service-Specific Status Table:
<a name=table1441></a>
Offset  Size    Description     (Table 01441)
00h    WORD    length of table in bytes
02h    DWORD   seconds since 0:00 1/1/70 when diagnostics last run
(FFFFFFFFh = never)
06h    DWORD   MAC status bits <a href="rb-2823.htm#Table1442">(see #01442)</a>
0Ah    WORD    current packet filter flags <a href="rb-2823.htm#Table1443">(see #01443)</a>
0Ch    DWORD   pointer to media-specific status table or 0000h:0000h
10h    DWORD   seconds past 0:00 1/1/70 of last ClearStatistics
14h    DWORD   total frames received (FFFFFFFFh = not counted)
18h    DWORD   frames with CRC error (FFFFFFFFh = not counted)
1Ch    DWORD   total bytes received (FFFFFFFFh = not counted)
20h    DWORD   frames discarded--no buffer space (FFFFFFFFh = not counted)
24h    DWORD   multicast frames received (FFFFFFFFh = not counted)
28h    DWORD   broadcast frames received (FFFFFFFFh = not counted)
2Ch    DWORD   frames with errors (FFFFFFFFh = not counted)
30h    DWORD   overly large frames (FFFFFFFFh = not counted)
34h    DWORD   frames less than minimum size (FFFFFFFFh = not counted)
38h    DWORD   multicast bytes received (FFFFFFFFh = not counted)
3Ch    DWORD   broadcast bytes received (FFFFFFFFh = not counted)
40h    DWORD   frames discarded--hardware error (FFFFFFFFh = not counted)
44h    DWORD   total frames transmitted (FFFFFFFFh = not counted)
48h    DWORD   total bytes transmitted (FFFFFFFFh = not counted)
4Ch    DWORD   multicast frames transmitted (FFFFFFFFh = not counted)
50h    DWORD   broadcast frames transmitted (FFFFFFFFh = not counted)
54h    DWORD   broadcast bytes transmitted (FFFFFFFFh = not counted)
58h    DWORD   multicast bytes transmitted (FFFFFFFFh = not counted)
5Ch    DWORD   frames not transmitted--timeout (FFFFFFFFh = not counted)
60h    DWORD   frames not transmitted--hardware error (FFFFFFFFh = not countd)
64h  N BYTEs   vendor-specific info
<p>
Bitfields for MAC status bits:
<a name=table1442></a>
Bit(s)  Description     (Table 01442)
0-2    operational status.
000 hardware not installed.
001 hardware failed startup diagnostics.
010 hardware configuration problem.
011 hardware fault.
100 operating marginally due to soft faults.
101 reserved.
110 reserved.
111 hardware fully operational
3      MAC bound
4      MAC open
5      diagnostics in progress
6-31   reserved
<p>
Bitfields for packet filter flags:
<a name=table1443></a>
Bit(s)  Description     (Table 01443)
0      directed/multicast or group/functional
1      broadcast
2      promiscuous
3      all source routing
4-15   reserved, must be zero
</PRE>
<p>
<b>Category: <a href="cat-027.htm">
Network</a>
- <a href="int-21.htm">
Int 21h</a>
- <a href="alpha-n.htm">
N</a>
</b><p><p><img src=./gif/rbline.gif width="100%" alt="------"><p>
<table border=1 cellpadding=3 cellspacing=1>
<td>
<a href="rb-2822.htm">
<img src=./gif/lup.gif border=0 alt=Prev></a>
<a href="rb-2824.htm">
<img src=./gif/ldown.gif border=0 alt=Next></a>
<a href="../rbrown.htm">
<img src=./gif/lhome.gif border=0 alt=Ralf Brown Page></a>
<td><a href="int.htm">Interrups</a></td>
<td><a href="cat.htm">Categories</a></td>
<td><a href="alpha.htm">Contents</a></td>
</td></table><p>



</BODY>
</HTML>
