<HTML>
<HEAD>
<TITLE>Int 21/AX=7304h
</TITLE>
<META NAME="Description" CONTENT="
Int 21/AX=7304h - Windows95 - FAT32 - Set DPB TO USE FOR FORMATTING - 
AX = 7304h
DL = drive number (00h=default, 01h=A:, etc.)
CX = size of buffer (must be at least 18h)
ES:DI - buffer for Set_DPBforFormat structure (see #01790)
Return: CF clear if successful
ES:DI buffer updated
CF set on error
AX = error code (18h = bad length in CX)
SeeAlso: AX=7302h,AX=7303h,AX=7305h
">
<META NAME="robots" CONTENT="none">
</HEAD>
<BODY BGCOLOR="#FFD0A0">
<center>
<h2>Int 21/AX=7304h
</h2>
</center><p>
<table border=1 cellpadding=3 cellspacing=1>
<td>
<a href="rb-3227.htm">
<img src=./gif/lup.gif border=0 alt=Prev></a>
<a href="rb-3229.htm">
<img src=./gif/ldown.gif border=0 alt=Next></a>
<a href="../rbrown.htm">
<img src=./gif/lhome.gif border=0 alt=Ralf Brown Page></a>
<td><a href="int.htm">Interrups</a></td>
<td><a href="cat.htm">Categories</a></td>
<td><a href="alpha.htm">Contents</a></td>
</td></table><p>
<p><img src=./gif/rbline.gif width="100%" alt="------"><p>
<h3><font color=#C00040>Windows95 - FAT32 - Set DPB TO USE FOR FORMATTING</font></h3>
<PRE>
AX = 7304h
DL = drive number (00h=default, 01h=A:, etc.)
CX = size of buffer (must be at least 18h)
ES:DI -> buffer for Set_DPBforFormat structure <a href="rb-3228.htm#Table1790">(see #01790)</a><br>
<p><b>Return:</b><br>CF clear if successful
ES:DI buffer updated
CF set on error
AX = error code (18h = bad length in CX)
</PRE>
<p><b>See Also:</b>
<a href="rb-3226.htm">AX=7302h</a> - <a href="rb-3227.htm">AX=7303h</a> - <a href="rb-3229.htm">AX=7305h</a>
<PRE>
<p>
Format of Set_DPBforFormat structure:
<a name=table1790></a>
Offset  Size    Description     (Table 01790)
00h    WORD    (call) size
02h    WORD    (call) structure version???  (0000h)
(ret) ???
04h    DWORD   (call) function number
00h invalidate DPB counts
01h rebuild DPB from BPB
02h force media change (next access to drive rebuild DPB)
03h get/set active FAT number and mirroring
04h get/set root directory cluster number
---function 00h---
08h    DWORD   new DPB free count (00000000h=no change, FFFFFFFFh=unknown)
0Ch    DWORD   new DPB next-free (00000000h=no change, FFFFFFFFh=unknown)
10h    DWORD   unused
14h    DWORD   unused
---function 01h---
08h    DWORD   unused???
0Ch    DWORD   (call) -> BIOS Parameter Block from which to rebuild DPB
10h    DWORD   unused
14h    DWORD   unused
---function 02h---
08h    DWORD   unused
0Ch    DWORD   unused
10h    DWORD   unused
14h    DWORD   unused
---function 03h---
08h    DWORD   (call) new active FAT/mirroring state, or FFFFFFFFh to get
<p><b>bits 3-0:</b><br>The 0-based FAT number of the active FAT
<p><b>bits 6-4:</b><br>Reserved (0)
<p><b>bit 7:</b><br>Do not mirror active FAT to inactive FATs
0Ch    DWORD   (ret) previous active FAT/mirroring state (as above)
10h    DWORD   unused
14h    DWORD   unused
---function 04h---
08h    DWORD   (call) new root directory cluster number
FFFFFFFFh to get current
0Ch    DWORD   (ret) previous root directory cluster number
10h    DWORD   unused
14h    DWORD   unused
</PRE>
<p>
<b>Category: <a href="cat-010.htm">
DOS Kernel</a>
- <a href="int-21.htm">
Int 21h</a>
- <a href="alpha-w.htm">
W</a>
</b><p><p><img src=./gif/rbline.gif width="100%" alt="------"><p>
<table border=1 cellpadding=3 cellspacing=1>
<td>
<a href="rb-3227.htm">
<img src=./gif/lup.gif border=0 alt=Prev></a>
<a href="rb-3229.htm">
<img src=./gif/ldown.gif border=0 alt=Next></a>
<a href="../rbrown.htm">
<img src=./gif/lhome.gif border=0 alt=Ralf Brown Page></a>
<td><a href="int.htm">Interrups</a></td>
<td><a href="cat.htm">Categories</a></td>
<td><a href="alpha.htm">Contents</a></td>
</td></table><p>



</BODY>
</HTML>
